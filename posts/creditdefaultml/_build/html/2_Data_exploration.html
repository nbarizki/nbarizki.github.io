
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Exploratory Analysis of LendingClub Loan Data &#8212; Implementing Machine Learning Model for Loan Classification and Selection</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Implementing Machine Learning Model to Predict and Select Loan" href="3_Model_development.html" />
    <link rel="prev" title="LendingClub Dataset - A collection of Peer-to-Peer Individual Loan History" href="1_Dataset_indentification_and_preprocessing.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Implementing Machine Learning Model for Loan Classification and Selection</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="README.html">
                    Implementing Machine Learning Model to Predict and Select Loan
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1_Dataset_indentification_and_preprocessing.html">
   LendingClub Dataset - A collection of Peer-to-Peer Individual Loan History
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Exploratory Analysis of LendingClub Loan Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3_Model_development.html">
   Implementing Machine Learning Model to Predict and Select Loan
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/nbarizki/creditdefaultml/main?urlpath=tree/2_Data_exploration.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/nbarizki/creditdefaultml"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/nbarizki/creditdefaultml/issues/new?title=Issue%20on%20page%20%2F2_Data_exploration.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/2_Data_exploration.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   1. Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dataset-characteristic">
   2.Dataset Characteristic
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-fields-containing-zero-or-missing-records">
     <strong>
      2.1 Data fields containing ‘Zero’ or ‘Missing’ records
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#applicant-profile">
     <strong>
      Applicant Profile
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loan-profile">
     <strong>
      Loan Profile
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-the-processor-class">
     <strong>
      Creating the Processor Class
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cardinality-of-data-fields-containing-objects-datatype">
     <strong>
      2.2 Cardinality of data fields containing
      <em>
       Objects
      </em>
      datatype
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#takeaway">
     <strong>
      Takeaway
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploratory-data-analytics">
   3. Exploratory Data Analytics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#categorical-data">
     3.1. Categorical Data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#loan-status">
       <strong>
        Loan Status
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#loan-category-along-time">
       <strong>
        Loan Category Along Time
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#loan-grade-by-loan-category">
       <strong>
        Loan Grade by Loan Category
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#employment-length-by-loan-status">
       <strong>
        Employment Length by Loan Status
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#home-ownership-by-loan-status">
       <strong>
        Home Ownership by Loan Status
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#loan-status-by-purpose">
       <strong>
        Loan Status by Purpose
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#loan-status-by-term">
       <strong>
        Loan Status by Term
       </strong>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numerical-data">
     3.2. Numerical Data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#loan-ecosystem-growth">
       <strong>
        Loan Ecosystem Growth
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#stability-of-interest-rate">
       <strong>
        Stability of Interest Rate
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#correlation-coefficient">
       <strong>
        Correlation Coefficient
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#multicollinearity">
       <strong>
        Multicollinearity
       </strong>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   4. Summary
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Exploratory Analysis of LendingClub Loan Data</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   1. Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dataset-characteristic">
   2.Dataset Characteristic
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-fields-containing-zero-or-missing-records">
     <strong>
      2.1 Data fields containing ‘Zero’ or ‘Missing’ records
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#applicant-profile">
     <strong>
      Applicant Profile
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loan-profile">
     <strong>
      Loan Profile
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-the-processor-class">
     <strong>
      Creating the Processor Class
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cardinality-of-data-fields-containing-objects-datatype">
     <strong>
      2.2 Cardinality of data fields containing
      <em>
       Objects
      </em>
      datatype
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#takeaway">
     <strong>
      Takeaway
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploratory-data-analytics">
   3. Exploratory Data Analytics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#categorical-data">
     3.1. Categorical Data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#loan-status">
       <strong>
        Loan Status
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#loan-category-along-time">
       <strong>
        Loan Category Along Time
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#loan-grade-by-loan-category">
       <strong>
        Loan Grade by Loan Category
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#employment-length-by-loan-status">
       <strong>
        Employment Length by Loan Status
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#home-ownership-by-loan-status">
       <strong>
        Home Ownership by Loan Status
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#loan-status-by-purpose">
       <strong>
        Loan Status by Purpose
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#loan-status-by-term">
       <strong>
        Loan Status by Term
       </strong>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numerical-data">
     3.2. Numerical Data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#loan-ecosystem-growth">
       <strong>
        Loan Ecosystem Growth
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#stability-of-interest-rate">
       <strong>
        Stability of Interest Rate
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#correlation-coefficient">
       <strong>
        Correlation Coefficient
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#multicollinearity">
       <strong>
        Multicollinearity
       </strong>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   4. Summary
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="exploratory-analysis-of-lendingclub-loan-data">
<h1>Exploratory Analysis of LendingClub Loan Data<a class="headerlink" href="#exploratory-analysis-of-lendingclub-loan-data" title="Permalink to this headline">#</a></h1>
<section id="introduction">
<h2>1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>In credit business, company has to make decision about loans approval based on the applicant’s profile. Company shall able to identify if the loan applicants is likely to repay the loan or not. The consequences are:</p>
<ul class="simple">
<li><p>If the applicants is able to repay the loan, missing this kind of applicants may result in business loss</p></li>
<li><p>If the applicants is not able to repay the loan, accepting the loan from this applicants is also result in business loss.</p></li>
</ul>
<p>Lending Club is peer-to-peer lending company, which people in needs can apply for loan, and some can become the investor by providing loan funding and later enjoy the interest as the profit.</p>
<p>While data growth is significant in this era, we can utilize it to become more useful. In this occasion, writer is trying to utilize <em>Lending Club Data</em> to predict creditworthiness of future loan applicants by developing a Machine Learning Model to predict if specific loan (defined by the loan structure and applicants background) will defaulted or not.</p>
</section>
<section id="dataset-characteristic">
<h2>2.Dataset Characteristic<a class="headerlink" href="#dataset-characteristic" title="Permalink to this headline">#</a></h2>
<p>Let’s first recall our dataset features:</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">modules.data_exploration</span> <span class="kn">import</span> <span class="n">DataExploration</span>
<span class="kn">from</span> <span class="nn">modules.data_preprocess</span> <span class="kn">import</span> <span class="n">LoanDataPreprocess</span>
<span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">dump</span><span class="p">,</span> <span class="n">load</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.float&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>

<span class="n">data_preprocess</span> <span class="o">=</span> <span class="n">LoanDataPreprocess</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">loan_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;dataset\lc_2010-2015.csv&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;desc&#39;</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="s1">&#39;verification_status_joint&#39;</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">})</span>
<span class="n">loan_df</span> <span class="o">=</span> <span class="n">data_preprocess</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">loan_df</span><span class="p">)</span>
<span class="n">loan_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>member_id</th>
      <th>loan_amnt</th>
      <th>funded_amnt</th>
      <th>funded_amnt_inv</th>
      <th>term</th>
      <th>int_rate</th>
      <th>installment</th>
      <th>grade</th>
      <th>sub_grade</th>
      <th>emp_title</th>
      <th>emp_length</th>
      <th>home_ownership</th>
      <th>annual_inc</th>
      <th>verification_status</th>
      <th>issue_d</th>
      <th>loan_status</th>
      <th>pymnt_plan</th>
      <th>desc</th>
      <th>purpose</th>
      <th>title</th>
      <th>zip_code</th>
      <th>addr_state</th>
      <th>dti</th>
      <th>delinq_2yrs</th>
      <th>earliest_cr_line</th>
      <th>inq_last_6mths</th>
      <th>mths_since_last_delinq</th>
      <th>mths_since_last_record</th>
      <th>open_acc</th>
      <th>pub_rec</th>
      <th>revol_bal</th>
      <th>revol_util</th>
      <th>total_acc</th>
      <th>initial_list_status</th>
      <th>out_prncp</th>
      <th>out_prncp_inv</th>
      <th>total_pymnt</th>
      <th>total_pymnt_inv</th>
      <th>total_rec_prncp</th>
      <th>total_rec_int</th>
      <th>total_rec_late_fee</th>
      <th>recoveries</th>
      <th>collection_recovery_fee</th>
      <th>last_pymnt_d</th>
      <th>last_pymnt_amnt</th>
      <th>next_pymnt_d</th>
      <th>last_credit_pull_d</th>
      <th>collections_12_mths_ex_med</th>
      <th>mths_since_last_major_derog</th>
      <th>policy_code</th>
      <th>application_type</th>
      <th>annual_inc_joint</th>
      <th>dti_joint</th>
      <th>verification_status_joint</th>
      <th>acc_now_delinq</th>
      <th>tot_coll_amt</th>
      <th>tot_cur_bal</th>
      <th>open_acc_6m</th>
      <th>open_il_12m</th>
      <th>open_il_24m</th>
      <th>mths_since_rcnt_il</th>
      <th>total_bal_il</th>
      <th>il_util</th>
      <th>open_rv_12m</th>
      <th>open_rv_24m</th>
      <th>max_bal_bc</th>
      <th>all_util</th>
      <th>total_rev_hi_lim</th>
      <th>inq_fi</th>
      <th>total_cu_tl</th>
      <th>inq_last_12m</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1077501.00</td>
      <td>1296599.00</td>
      <td>5000.00</td>
      <td>5000.00</td>
      <td>4975.00</td>
      <td>36 months</td>
      <td>10.65</td>
      <td>162.87</td>
      <td>B</td>
      <td>B2</td>
      <td>NaN</td>
      <td>more 10 years</td>
      <td>RENT</td>
      <td>24000.00</td>
      <td>Verified</td>
      <td>2011-12-01</td>
      <td>Fully Paid</td>
      <td>n</td>
      <td>Borrower added on 12/22/11 &gt; I need to upgrade...</td>
      <td>credit_card</td>
      <td>Computer</td>
      <td>860xx</td>
      <td>AZ</td>
      <td>27.65</td>
      <td>0.00</td>
      <td>1985-01-01</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.00</td>
      <td>0.00</td>
      <td>13648.00</td>
      <td>83.70</td>
      <td>9.00</td>
      <td>f</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>5861.07</td>
      <td>5831.78</td>
      <td>5000.00</td>
      <td>861.07</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>2015-01-01</td>
      <td>171.62</td>
      <td>NaT</td>
      <td>2016-01-01</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>INDIVIDUAL</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1077430.00</td>
      <td>1314167.00</td>
      <td>2500.00</td>
      <td>2500.00</td>
      <td>2500.00</td>
      <td>60 months</td>
      <td>15.27</td>
      <td>59.83</td>
      <td>C</td>
      <td>C4</td>
      <td>Ryder</td>
      <td>less 1 year</td>
      <td>RENT</td>
      <td>30000.00</td>
      <td>Source Verified</td>
      <td>2011-12-01</td>
      <td>Charged Off</td>
      <td>n</td>
      <td>Borrower added on 12/22/11 &gt; I plan to use thi...</td>
      <td>car</td>
      <td>bike</td>
      <td>309xx</td>
      <td>GA</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>1999-04-01</td>
      <td>5.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.00</td>
      <td>0.00</td>
      <td>1687.00</td>
      <td>9.40</td>
      <td>4.00</td>
      <td>f</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1008.71</td>
      <td>1008.71</td>
      <td>456.46</td>
      <td>435.17</td>
      <td>0.00</td>
      <td>117.08</td>
      <td>1.11</td>
      <td>2013-04-01</td>
      <td>119.66</td>
      <td>NaT</td>
      <td>2013-09-01</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>INDIVIDUAL</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1077175.00</td>
      <td>1313524.00</td>
      <td>2400.00</td>
      <td>2400.00</td>
      <td>2400.00</td>
      <td>36 months</td>
      <td>15.96</td>
      <td>84.33</td>
      <td>C</td>
      <td>C5</td>
      <td>NaN</td>
      <td>more 10 years</td>
      <td>RENT</td>
      <td>12252.00</td>
      <td>Not Verified</td>
      <td>2011-12-01</td>
      <td>Fully Paid</td>
      <td>n</td>
      <td>NaN</td>
      <td>small_business</td>
      <td>real estate business</td>
      <td>606xx</td>
      <td>IL</td>
      <td>8.72</td>
      <td>0.00</td>
      <td>2001-11-01</td>
      <td>2.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.00</td>
      <td>0.00</td>
      <td>2956.00</td>
      <td>98.50</td>
      <td>10.00</td>
      <td>f</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>3003.65</td>
      <td>3003.65</td>
      <td>2400.00</td>
      <td>603.65</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>2014-06-01</td>
      <td>649.91</td>
      <td>NaT</td>
      <td>2016-01-01</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>INDIVIDUAL</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1076863.00</td>
      <td>1277178.00</td>
      <td>10000.00</td>
      <td>10000.00</td>
      <td>10000.00</td>
      <td>36 months</td>
      <td>13.49</td>
      <td>339.31</td>
      <td>C</td>
      <td>C1</td>
      <td>AIR RESOURCES BOARD</td>
      <td>more 10 years</td>
      <td>RENT</td>
      <td>49200.00</td>
      <td>Source Verified</td>
      <td>2011-12-01</td>
      <td>Fully Paid</td>
      <td>n</td>
      <td>Borrower added on 12/21/11 &gt; to pay for proper...</td>
      <td>other</td>
      <td>personel</td>
      <td>917xx</td>
      <td>CA</td>
      <td>20.00</td>
      <td>0.00</td>
      <td>1996-02-01</td>
      <td>1.00</td>
      <td>35.00</td>
      <td>NaN</td>
      <td>10.00</td>
      <td>0.00</td>
      <td>5598.00</td>
      <td>21.00</td>
      <td>37.00</td>
      <td>f</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>12226.30</td>
      <td>12226.30</td>
      <td>10000.00</td>
      <td>2209.33</td>
      <td>16.97</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>2015-01-01</td>
      <td>357.48</td>
      <td>NaT</td>
      <td>2015-01-01</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>INDIVIDUAL</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1075358.00</td>
      <td>1311748.00</td>
      <td>3000.00</td>
      <td>3000.00</td>
      <td>3000.00</td>
      <td>60 months</td>
      <td>12.69</td>
      <td>67.79</td>
      <td>B</td>
      <td>B5</td>
      <td>University Medical Group</td>
      <td>1 year</td>
      <td>RENT</td>
      <td>80000.00</td>
      <td>Source Verified</td>
      <td>2011-12-01</td>
      <td>Current</td>
      <td>n</td>
      <td>Borrower added on 12/21/11 &gt; I plan on combini...</td>
      <td>other</td>
      <td>Personal</td>
      <td>972xx</td>
      <td>OR</td>
      <td>17.94</td>
      <td>0.00</td>
      <td>1996-01-01</td>
      <td>0.00</td>
      <td>38.00</td>
      <td>NaN</td>
      <td>15.00</td>
      <td>0.00</td>
      <td>27783.00</td>
      <td>53.90</td>
      <td>38.00</td>
      <td>f</td>
      <td>766.90</td>
      <td>766.90</td>
      <td>3242.17</td>
      <td>3242.17</td>
      <td>2233.10</td>
      <td>1009.07</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>2016-01-01</td>
      <td>67.79</td>
      <td>2016-02-01</td>
      <td>2016-01-01</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>INDIVIDUAL</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="data-fields-containing-zero-or-missing-records">
<h3><strong>2.1 Data fields containing ‘Zero’ or ‘Missing’ records</strong><a class="headerlink" href="#data-fields-containing-zero-or-missing-records" title="Permalink to this headline">#</a></h3>
<p>I will give a more detailed review for data fields that has <em>non-null</em> less than total records. They must have <em>zeroes</em> or <em>missing records (NaN)</em> and needed to be identified, since each value may have different meaning (for example, <em>0</em> in datafield <em>open_acc</em> means no current credit account opened while <em>missing/NaN</em> records clearly explain that no information recorded).
After this review, we can consider how to deal with this condition for preparation of machine learning features.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">applicant_features</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;member_id&#39;</span><span class="p">,</span> <span class="s1">&#39;emp_title&#39;</span><span class="p">,</span> <span class="s1">&#39;emp_length&#39;</span><span class="p">,</span> <span class="s1">&#39;home_ownership&#39;</span><span class="p">,</span>
    <span class="s1">&#39;annual_inc&#39;</span><span class="p">,</span> <span class="s1">&#39;verification_status&#39;</span><span class="p">,</span> <span class="s1">&#39;dti&#39;</span><span class="p">,</span> <span class="s1">&#39;delinq_2yrs&#39;</span><span class="p">,</span>
    <span class="s1">&#39;earliest_cr_line&#39;</span><span class="p">,</span> <span class="s1">&#39;inq_last_6mths&#39;</span><span class="p">,</span> <span class="s1">&#39;mths_since_last_delinq&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mths_since_last_record&#39;</span><span class="p">,</span> <span class="s1">&#39;open_acc&#39;</span><span class="p">,</span> <span class="s1">&#39;revol_bal&#39;</span><span class="p">,</span> <span class="s1">&#39;revol_util&#39;</span><span class="p">,</span>
    <span class="s1">&#39;total_acc&#39;</span><span class="p">,</span> <span class="s1">&#39;collections_12_mths_ex_med&#39;</span><span class="p">,</span> <span class="s1">&#39;mths_since_last_major_derog&#39;</span><span class="p">,</span>
    <span class="s1">&#39;policy_code&#39;</span><span class="p">,</span> <span class="s1">&#39;annual_inc_joint&#39;</span><span class="p">,</span> <span class="s1">&#39;dti_joint&#39;</span><span class="p">,</span> <span class="s1">&#39;verification_status_joint&#39;</span><span class="p">,</span>
    <span class="s1">&#39;acc_now_delinq&#39;</span><span class="p">,</span> <span class="s1">&#39;tot_coll_amt&#39;</span><span class="p">,</span> <span class="s1">&#39;tot_cur_bal&#39;</span><span class="p">,</span> <span class="s1">&#39;open_acc_6m&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;open_il_12m&#39;</span><span class="p">,</span> <span class="s1">&#39;open_il_24m&#39;</span><span class="p">,</span> <span class="s1">&#39;mths_since_rcnt_il&#39;</span><span class="p">,</span> <span class="s1">&#39;total_bal_il&#39;</span><span class="p">,</span>
    <span class="s1">&#39;il_util&#39;</span><span class="p">,</span> <span class="s1">&#39;open_rv_12m&#39;</span><span class="p">,</span> <span class="s1">&#39;open_rv_24m&#39;</span><span class="p">,</span> <span class="s1">&#39;all_util&#39;</span><span class="p">,</span> <span class="s1">&#39;total_rev_hi_lim&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;inq_fi&#39;</span><span class="p">,</span> <span class="s1">&#39;total_cu_tl&#39;</span><span class="p">,</span> <span class="s1">&#39;inq_last_12m&#39;</span><span class="p">,</span> <span class="s1">&#39;pub_rec&#39;</span><span class="p">,</span> <span class="s1">&#39;max_bal_bc&#39;</span>
    <span class="p">]</span>
<span class="n">loan_features</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_amnt&#39;</span><span class="p">,</span> <span class="s1">&#39;term&#39;</span><span class="p">,</span> <span class="s1">&#39;int_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;installment&#39;</span><span class="p">,</span> <span class="s1">&#39;grade&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sub_grade&#39;</span><span class="p">,</span> <span class="s1">&#39;pymnt_plan&#39;</span><span class="p">,</span> <span class="s1">&#39;desc&#39;</span><span class="p">,</span> <span class="s1">&#39;purpose&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">,</span>
    <span class="s1">&#39;zip_code&#39;</span><span class="p">,</span> <span class="s1">&#39;addr_state&#39;</span><span class="p">,</span> <span class="s1">&#39;policy_code&#39;</span><span class="p">,</span> <span class="s1">&#39;application_type&#39;</span>
    <span class="p">]</span>
<span class="n">post_origin_features</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;funded_amnt&#39;</span><span class="p">,</span> <span class="s1">&#39;funded_amnt_inv&#39;</span><span class="p">,</span> <span class="s1">&#39;issue_d&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;initial_list_status&#39;</span><span class="p">,</span> <span class="s1">&#39;out_prncp&#39;</span><span class="p">,</span> <span class="s1">&#39;out_prncp_inv&#39;</span><span class="p">,</span> <span class="s1">&#39;total_rec_prncp&#39;</span><span class="p">,</span>
    <span class="s1">&#39;total_rec_int&#39;</span><span class="p">,</span> <span class="s1">&#39;total_rec_late_fee&#39;</span><span class="p">,</span> <span class="s1">&#39;recoveries&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_recovery_fee&#39;</span><span class="p">,</span>
    <span class="s1">&#39;last_pymnt_d&#39;</span><span class="p">,</span> <span class="s1">&#39;last_pymnt_amnt&#39;</span><span class="p">,</span> <span class="s1">&#39;next_pymnt_d&#39;</span><span class="p">,</span> <span class="s1">&#39;last_credit_pull_d&#39;</span><span class="p">,</span>
    <span class="s1">&#39;total_pymnt&#39;</span><span class="p">,</span> <span class="s1">&#39;total_pymnt_inv&#39;</span>
    <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>It is best to categorize the missing data based on the type of missing. Most commonly known types of missing data are as follows:</p>
<ul class="simple">
<li><p><strong>Structurally missing data</strong>, is the data that is missing for a logical reason, since that reason caused them to not exist. For example from our data, missing data of <code class="docutils literal notranslate"><span class="pre">annual_inc_joint</span></code> is a structural missing if the loan’s <code class="docutils literal notranslate"><span class="pre">application_type</span></code> is <code class="docutils literal notranslate"><span class="pre">INDIVIDUAL</span></code> loan rather than <code class="docutils literal notranslate"><span class="pre">JOINT</span></code> loan.</p></li>
<li><p><strong>Missing Completely at Random (MCAR)</strong>, is the data that is missing with no reasonable connection or pattern to another data. For example, <code class="docutils literal notranslate"><span class="pre">ann_inc</span></code> is very specific record of each observation, hence missing this record is categorized as MCAR. Since we can do nothing to overcome this missing value, the most possible action is to drop the observations if the feature is crucial to avoid any possible biases.</p></li>
<li><p><strong>Missing at Random (MAR)</strong>, is the data that is missing but the connection or pattern can be predicted (e.g. using extrapolation) or extracted from combination of other features (e.g. substraction, summation, etc.). For example, if an observation has a missing <code class="docutils literal notranslate"><span class="pre">int_rate</span></code> record, we can possibly calculate it by using <code class="docutils literal notranslate"><span class="pre">loan_amnt</span></code> and <code class="docutils literal notranslate"><span class="pre">total_pymnt</span></code>.</p></li>
<li><p><strong>Missing not at Random (MNAR)</strong>, is the data where the reason or mechanism for why the data is missing is known. For example, missing loan <code class="docutils literal notranslate"><span class="pre">desc</span></code> is known because the loan applicant didn’t input it to the system.</p></li>
</ul>
</section>
<section id="applicant-profile">
<h3><strong>Applicant Profile</strong><a class="headerlink" href="#applicant-profile" title="Permalink to this headline">#</a></h3>
<p><em>Applicant Profile</em> and <em>Loan Profile</em> is our main features for developing the machine learning model. Action to overcome the missing features will be explained accordingly. Let’s start with <em>Applicant Profile</em>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_exploration</span> <span class="o">=</span> <span class="n">DataExploration</span><span class="p">(</span><span class="n">loan_df</span><span class="p">)</span>
<span class="n">data_exploration</span><span class="o">.</span><span class="n">show_nans_or_zeroes</span><span class="p">(</span><span class="s1">&#39;nans&#39;</span><span class="p">,</span> <span class="n">applicant_features</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Nans Count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Nans Count</th>
      <th>Nans Percentage (%)</th>
      <th>Data Types</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>dti_joint</th>
      <td>886870</td>
      <td>99.94</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>annual_inc_joint</th>
      <td>886868</td>
      <td>99.94</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>verification_status_joint</th>
      <td>886868</td>
      <td>99.94</td>
      <td>category</td>
    </tr>
    <tr>
      <th>il_util</th>
      <td>868762</td>
      <td>97.90</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>mths_since_rcnt_il</th>
      <td>866569</td>
      <td>97.65</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>inq_last_12m</th>
      <td>866007</td>
      <td>97.59</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>total_cu_tl</th>
      <td>866007</td>
      <td>97.59</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>inq_fi</th>
      <td>866007</td>
      <td>97.59</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>all_util</th>
      <td>866007</td>
      <td>97.59</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>open_rv_24m</th>
      <td>866007</td>
      <td>97.59</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>open_rv_12m</th>
      <td>866007</td>
      <td>97.59</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>total_bal_il</th>
      <td>866007</td>
      <td>97.59</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>open_il_24m</th>
      <td>866007</td>
      <td>97.59</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>open_il_12m</th>
      <td>866007</td>
      <td>97.59</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>open_acc_6m</th>
      <td>866007</td>
      <td>97.59</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>max_bal_bc</th>
      <td>866007</td>
      <td>97.59</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>mths_since_last_record</th>
      <td>750326</td>
      <td>84.56</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>mths_since_last_major_derog</th>
      <td>665676</td>
      <td>75.02</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>mths_since_last_delinq</th>
      <td>454312</td>
      <td>51.20</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>total_rev_hi_lim</th>
      <td>70276</td>
      <td>7.92</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>tot_coll_amt</th>
      <td>70276</td>
      <td>7.92</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>tot_cur_bal</th>
      <td>70276</td>
      <td>7.92</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>emp_title</th>
      <td>51462</td>
      <td>5.80</td>
      <td>object</td>
    </tr>
    <tr>
      <th>emp_length</th>
      <td>44825</td>
      <td>5.05</td>
      <td>category</td>
    </tr>
    <tr>
      <th>revol_util</th>
      <td>502</td>
      <td>0.06</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>collections_12_mths_ex_med</th>
      <td>145</td>
      <td>0.02</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>open_acc</th>
      <td>29</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>acc_now_delinq</th>
      <td>29</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>inq_last_6mths</th>
      <td>29</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>earliest_cr_line</th>
      <td>29</td>
      <td>0.00</td>
      <td>datetime64[ns]</td>
    </tr>
    <tr>
      <th>delinq_2yrs</th>
      <td>29</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>total_acc</th>
      <td>29</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>pub_rec</th>
      <td>29</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>annual_inc</th>
      <td>4</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>revol_bal</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>dti</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>verification_status</th>
      <td>0</td>
      <td>0.00</td>
      <td>category</td>
    </tr>
    <tr>
      <th>home_ownership</th>
      <td>0</td>
      <td>0.00</td>
      <td>category</td>
    </tr>
    <tr>
      <th>policy_code</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>member_id</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ol class="simple">
<li><p>Structurally Missing: <code class="docutils literal notranslate"><span class="pre">total_rev_hi_lim</span></code>, <code class="docutils literal notranslate"><span class="pre">tot_coll_amnt</span></code>, <code class="docutils literal notranslate"><span class="pre">tot_curr_bal</span></code>, <code class="docutils literal notranslate"><span class="pre">revol_util</span></code>, <code class="docutils literal notranslate"><span class="pre">collections_12_mths_ex_med</span></code>, <code class="docutils literal notranslate"><span class="pre">inq_last_6mths</span></code>, <code class="docutils literal notranslate"><span class="pre">delinq_2yrs</span></code>, <code class="docutils literal notranslate"><span class="pre">earliest_cr_line</span></code>, <code class="docutils literal notranslate"><span class="pre">total_acc</span></code>, <code class="docutils literal notranslate"><span class="pre">open_acc</span></code>, <code class="docutils literal notranslate"><span class="pre">acc_now_delinq</span></code>, and most of the features that has a high percentage of missing data (<span class="math notranslate nohighlight">\(&gt;\)</span> 50%). Note on missing percentage of <code class="docutils literal notranslate"><span class="pre">_joint</span></code> features, we can easily confirm that most of the loan is <code class="docutils literal notranslate"><span class="pre">INDIVIDUAL</span></code> loan. We will drop the observations with <code class="docutils literal notranslate"><span class="pre">JOINT</span></code> type loan due to limited data compared to <code class="docutils literal notranslate"><span class="pre">INDIVIDUAL</span></code> loan hence limiting the scope of the model to covers only <code class="docutils literal notranslate"><span class="pre">INDIVIDUAL</span></code> loan. For features related to <code class="docutils literal notranslate"><span class="pre">mnths_since_</span></code>, <code class="docutils literal notranslate"><span class="pre">NaN</span></code> will be replaced with some large values (happens ‘long ago’), otherwise <code class="docutils literal notranslate"><span class="pre">1</span></code> (happens recently).</p></li>
<li><p>MNAR: <code class="docutils literal notranslate"><span class="pre">emp_title</span></code>. High cardinal data won’t be used for machine learning features.</p></li>
<li><p>MCAR: <code class="docutils literal notranslate"><span class="pre">annual_inc</span></code>, <code class="docutils literal notranslate"><span class="pre">emp_length</span></code>, <code class="docutils literal notranslate"><span class="pre">earliest_cr_line</span></code>. Observations with misisng <code class="docutils literal notranslate"><span class="pre">annual_inc</span></code> will be dropped. For <code class="docutils literal notranslate"><span class="pre">emp_length</span></code>, we will one-hot encode this and also provide <em>out-of-vocabulary</em> dummy variables for this missing data. <code class="docutils literal notranslate"><span class="pre">earlist_cr_line</span></code> will be utilized for feature extraction.</p></li>
</ol>
<p>More on <em>Structurally Missing</em> data that possibly includes <em>MCAR</em>, <em>MAR</em>, or <em>MNAR</em> (this will be a bit detailed, <a class="reference external" href="#skip_to_cardinality">click to skip</a>):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mths_since_last_record</span></code> is linked with <code class="docutils literal notranslate"><span class="pre">pub_rec</span></code>. Missing records is proportional with <em>zeroes</em> records in <code class="docutils literal notranslate"><span class="pre">pub_rec</span></code>. For this features. Replacing missing records in <code class="docutils literal notranslate"><span class="pre">mths_since_last_record</span></code> with <em>zeroes</em> while <code class="docutils literal notranslate"><span class="pre">pub_rec</span></code> is zero is valid. But if any of the missing value when <code class="docutils literal notranslate"><span class="pre">pub_rec</span></code> is not zero (leads to MCAR), the exact method to replace this missing value is non-existence. Let’s see how many of this condition. We will proceed to replace as <code class="docutils literal notranslate"><span class="pre">1</span></code> if MCAR (assume worst condition, which pub record happened recently). Since the higher the <code class="docutils literal notranslate"><span class="pre">mths_since_last_record</span></code> associated with the lower power of delinquecies, we replace the structurally missing data with value large enough but sufficient.</p></li>
</ul>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>Condition</th>
      <th>mths_since_last_record</th>
      <th>pub_rec</th>
      <th>Remarks</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</th>
      <td>NaN</th>
      <td>0</td>
      <td>Structurally Missing</td>
    </tr>
    <tr>
      <td>2</th>
      <td>NaN</th>
      <td>> 0</td>
      <td>MCAR</td>
    </tr>
    <tr>
      <td>3</th>
      <td>NaN</th>
      <td>NaN</td>
      <td>MNAR</td>
    </tr>
    </tbody> 
 </table><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rec_condition_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">mths_since_last_record</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">pub_rec</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">rec_condition_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">mths_since_last_record</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">pub_rec</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">rec_condition_3</span> <span class="o">=</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">mths_since_last_record</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">pub_rec</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>

<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">rec_condition_1</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mths_since_last_record&#39;</span><span class="p">,</span> <span class="s1">&#39;pub_rec&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mths_since_last_record</th>
      <th>pub_rec</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>Charged Off</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>887371</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>Charged Off</td>
    </tr>
    <tr>
      <th>887372</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>887373</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>887375</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>887377</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
  </tbody>
</table>
<p>750297 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">rec_condition_2</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mths_since_last_record&#39;</span><span class="p">,</span> <span class="s1">&#39;pub_rec&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mths_since_last_record</th>
      <th>pub_rec</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">rec_condition_3</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mths_since_last_record&#39;</span><span class="p">,</span> <span class="s1">&#39;pub_rec&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1">#length = 29</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mths_since_last_record</th>
      <th>pub_rec</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>42449</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42450</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42459</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42472</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42480</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>As we can see, observations with missing `mths_since_last_record` and `pub_rec` togetherly are tagged as `Does not meet the credit policy`. It is possibly caused by an incomplete data submission, which doesn&#39;t meet the LendingClub policy. That is why I tagged them as MNAR (this is subjective, assumming that condition). All of the cases and assumption that we use above ideally shall be communicated to the party that responsible in data recording or maybe the stakeholders. More features explained in this section are also shown similar results.
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mths_since_last_delinq</span></code> is linked with <code class="docutils literal notranslate"><span class="pre">delinq_2yrs</span></code> and <code class="docutils literal notranslate"><span class="pre">acc_now_delinq</span></code> this way: 1) records with <code class="docutils literal notranslate"><span class="pre">mths_since_last_delinq</span></code> <span class="math notranslate nohighlight">\(\leq\)</span> 24 will prove <code class="docutils literal notranslate"><span class="pre">delinq_2yrs</span></code> at least 1, if &gt; 24 then <code class="docutils literal notranslate"><span class="pre">delinq_2yrs</span></code> must be 0; 2) if <code class="docutils literal notranslate"><span class="pre">acc_now_delinq</span></code> is &gt; 0, then <code class="docutils literal notranslate"><span class="pre">mths_since_last_delinq</span></code> should be recent = 0. We can ignore the MCAR for <code class="docutils literal notranslate"><span class="pre">condition</span> <span class="pre">1</span></code> since it is possibly rare.</p></li>
</ul>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>Condition</th>
      <th>mths_since_last_delinq</th>
      <th>delinq_2yrs</th>
      <th>acc_now_delinq</th>
      <th>Remarks</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</th>
      <td>NaN</th>
      <td>0</td>
      <td> 0</td>
      <td>Structurally Missing, MCAR (if last delinq > 2 years)</td>
    </tr>
    <tr>
      <td>2</th>
      <td>NaN</th>
      <td>>0</td>
      <td>> 0</td>
      <td>MAR, should be 0</td>
    </tr>
    <tr>
      <td>3</th>
      <td>NaN</th>
      <td>>0</td>
      <td>0</td>
      <td>MCAR. Impute median from similar available records</td>
    </tr>
    <tr>
      <td>4</th>
      <td>0</th>
      <td>>0</td>
      <td>0</td>
      <td>Error. Impute similar to Case #3</td>
    </tr>
    <tr>
      <td>5</th>
      <td>0 < x < 24</th>
      <td>0</td>
      <td>0</td>
      <td>Error. Worst case impute, delinq_2_yrs = 1.</td>
    </tr>
    <tr>
      <td>6</th>
      <td>0</th>
      <td>0</td>
      <td>0</td>
      <td>Error. mnths_since_last_delinq = 99</td>
    </tr>
    <tr>
      <td>8</th>
      <td>NaN</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>MNAR</td>
    </tr>
    </tbody>  
</table><div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Structurally missing will be replaced as 300</span>
<span class="c1"># MAR should be replaced by 1</span>
<span class="c1"># MCAR should be imputed (preferably mean)</span>
<span class="c1"># Error should be dropped</span>

<span class="n">last_delinq_condition_1</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">mths_since_last_delinq</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">delinq_2yrs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">acc_now_delinq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">last_delinq_condition_2</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">mths_since_last_delinq</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">delinq_2yrs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">acc_now_delinq</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">last_delinq_condition_3</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">mths_since_last_delinq</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">delinq_2yrs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">acc_now_delinq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">last_delinq_condition_4</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">mths_since_last_delinq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">delinq_2yrs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">acc_now_delinq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">last_delinq_condition_5</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">mths_since_last_delinq</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="n">inclusive</span><span class="o">=</span><span class="s1">&#39;neither&#39;</span><span class="p">))</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">delinq_2yrs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">acc_now_delinq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">last_delinq_condition_6</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">mths_since_last_delinq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">delinq_2yrs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">acc_now_delinq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">last_delinq_condition_7</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">mths_since_last_delinq</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">delinq_2yrs</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">acc_now_delinq</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>

<span class="c1"># Replace with large number</span>
<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">last_delinq_condition_1</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mths_since_last_delinq&#39;</span><span class="p">,</span> <span class="s1">&#39;delinq_2yrs&#39;</span><span class="p">,</span> <span class="s1">&#39;acc_now_delinq&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mths_since_last_delinq</th>
      <th>delinq_2yrs</th>
      <th>acc_now_delinq</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Charged Off</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>887369</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>887373</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>887374</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>887376</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>887378</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
  </tbody>
</table>
<p>452180 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># MAR, shall be 0</span>
<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">last_delinq_condition_2</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mths_since_last_delinq&#39;</span><span class="p">,</span> <span class="s1">&#39;delinq_2yrs&#39;</span><span class="p">,</span> <span class="s1">&#39;acc_now_delinq&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mths_since_last_delinq</th>
      <th>delinq_2yrs</th>
      <th>acc_now_delinq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>467661</th>
      <td>NaN</td>
      <td>1.00</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>468634</th>
      <td>NaN</td>
      <td>1.00</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>480852</th>
      <td>NaN</td>
      <td>2.00</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>514024</th>
      <td>NaN</td>
      <td>1.00</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>636977</th>
      <td>NaN</td>
      <td>2.00</td>
      <td>2.00</td>
    </tr>
    <tr>
      <th>674429</th>
      <td>NaN</td>
      <td>1.00</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>742926</th>
      <td>NaN</td>
      <td>2.00</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>752588</th>
      <td>NaN</td>
      <td>7.00</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>775355</th>
      <td>NaN</td>
      <td>2.00</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># MCAR, imputed (preferably median of similar condition)</span>
<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">last_delinq_condition_3</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mths_since_last_delinq&#39;</span><span class="p">,</span> <span class="s1">&#39;delinq_2yrs&#39;</span><span class="p">,</span> <span class="s1">&#39;acc_now_delinq&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mths_since_last_delinq</th>
      <th>delinq_2yrs</th>
      <th>acc_now_delinq</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>43607</th>
      <td>NaN</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>44894</th>
      <td>NaN</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>44932</th>
      <td>NaN</td>
      <td>3.00</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>45181</th>
      <td>NaN</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>45305</th>
      <td>NaN</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>880608</th>
      <td>NaN</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>884799</th>
      <td>NaN</td>
      <td>3.00</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>884875</th>
      <td>NaN</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>885177</th>
      <td>NaN</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>885476</th>
      <td>NaN</td>
      <td>17.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
  </tbody>
</table>
<p>2094 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Logically Error</span>
<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">last_delinq_condition_4</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mths_since_last_delinq&#39;</span><span class="p">,</span> <span class="s1">&#39;delinq_2yrs&#39;</span><span class="p">,</span> <span class="s1">&#39;acc_now_delinq&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mths_since_last_delinq</th>
      <th>delinq_2yrs</th>
      <th>acc_now_delinq</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Error. Assumes delinq_2_yrs = 1</span>
<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">last_delinq_condition_5</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mths_since_last_delinq&#39;</span><span class="p">,</span> <span class="s1">&#39;delinq_2yrs&#39;</span><span class="p">,</span> <span class="s1">&#39;acc_now_delinq&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mths_since_last_delinq</th>
      <th>delinq_2yrs</th>
      <th>acc_now_delinq</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>265785</th>
      <td>13.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>269893</th>
      <td>19.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>284405</th>
      <td>17.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>287086</th>
      <td>16.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>288985</th>
      <td>21.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>780603</th>
      <td>13.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>800858</th>
      <td>22.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>803082</th>
      <td>14.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>854358</th>
      <td>18.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>886917</th>
      <td>21.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
  </tbody>
</table>
<p>78 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Error. months_since_last_delinq = 300</span>
<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">last_delinq_condition_6</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mths_since_last_delinq&#39;</span><span class="p">,</span> <span class="s1">&#39;delinq_2yrs&#39;</span><span class="p">,</span> <span class="s1">&#39;acc_now_delinq&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mths_since_last_delinq</th>
      <th>delinq_2yrs</th>
      <th>acc_now_delinq</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>35075</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>35431</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Charged Off</td>
    </tr>
    <tr>
      <th>38786</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>38797</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>38945</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>42507</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42508</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42511</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42513</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>692130</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
  </tbody>
</table>
<p>821 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Preferably drop the observations that doesn&#39;t meet policy</span>
<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">last_delinq_condition_7</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mths_since_last_delinq&#39;</span><span class="p">,</span> <span class="s1">&#39;delinq_2yrs&#39;</span><span class="p">,</span> <span class="s1">&#39;acc_now_delinq&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1">#length = 29</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mths_since_last_delinq</th>
      <th>delinq_2yrs</th>
      <th>acc_now_delinq</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>42450</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42509</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42514</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42472</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42534</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">inq_last_6mths</span></code>, <code class="docutils literal notranslate"><span class="pre">inq_last_12mths</span></code> are linked with <code class="docutils literal notranslate"><span class="pre">inq_fi</span></code>. Missing last inquiries records is ambiguous if <code class="docutils literal notranslate"><span class="pre">inq_fi</span></code> &gt; 0.</p></li>
</ul>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>Condition</th>
      <th>inq_last_6mths</th>
      <th>inq_last_12mths</th>
      <th>inq_fi</th>
      <th>Remarks</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</th>
      <td>NaN</th>
      <td>NaN</td>
      <td>0</td>
      <td>Structurally Missing</td>
    </tr>
    <tr>
      <td>2</th>
      <td>NaN</th>
      <td>NaN</td>
      <td>>0</td>
      <td>MCAR, assume = inq_fi</td>
    </tr>
    <tr>
      <td>3</th>
      <td>NaN</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>MNAR</td>
    </tr>
    </tbody>  
</table><div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inq_condition_1</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">inq_last_6mths</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">|</span> <span class="n">loan_df</span><span class="o">.</span><span class="n">inq_last_12m</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">inq_fi</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">inq_condition_2</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">inq_last_6mths</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">|</span> <span class="n">loan_df</span><span class="o">.</span><span class="n">inq_last_12m</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">inq_fi</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">inq_condition_3</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">inq_last_6mths</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">loan_df</span><span class="o">.</span><span class="n">inq_last_12m</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">inq_fi</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>

<span class="c1"># Replace as 0</span>
<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">inq_condition_1</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;inq_last_6mths&#39;</span><span class="p">,</span> <span class="s1">&#39;inq_last_12m&#39;</span><span class="p">,</span> <span class="s1">&#39;inq_fi&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inq_last_6mths</th>
      <th>inq_last_12m</th>
      <th>inq_fi</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># drop the observations</span>
<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">inq_condition_2</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;inq_last_6mths&#39;</span><span class="p">,</span> <span class="s1">&#39;inq_last_12m&#39;</span><span class="p">,</span> <span class="s1">&#39;inq_fi&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inq_last_6mths</th>
      <th>inq_last_12m</th>
      <th>inq_fi</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># preferably drop the observations</span>
<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">inq_condition_3</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;inq_last_6mths&#39;</span><span class="p">,</span> <span class="s1">&#39;inq_last_12m&#39;</span><span class="p">,</span> <span class="s1">&#39;inq_fi&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># length = 29</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inq_last_6mths</th>
      <th>inq_last_12m</th>
      <th>inq_fi</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>42480</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42514</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42520</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42450</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42472</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">open_acc</span></code> is linked with <code class="docutils literal notranslate"><span class="pre">total_open_acc</span></code> are linked with <code class="docutils literal notranslate"><span class="pre">inq_fi</span></code>. Missing <code class="docutils literal notranslate"><span class="pre">open_acc</span></code> while <code class="docutils literal notranslate"><span class="pre">total_open_acc</span></code> &gt; 0 (and vice versa) is ambiguous.</p></li>
</ul>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>Condition</th>
      <th>open_acc</th>
      <th>total_open_acc</th>
      <th>Remarks</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</th>
      <td>NaN</th>
      <td>0</td>
      <td>Structurally Missing</td>
    </tr>
    <tr>
      <td>2</th>
      <td>0</th>
      <td>NaN</td>
      <td>Structurally Missing</td>
    </tr>
    <tr>
      <td>3</th>
      <td>NaN</th>
      <td>>0</td>
      <td>MCAR</td>
    </tr>
    <tr>
      <td>4</th>
      <td>>0</th>
      <td>NaN</td>
      <td>MCAR</td>
    </tr>
    <tr>
      <td>5</th>
      <td>NaN</th>
      <td>NaN</td>
      <td>MNAR</td>
    </tr>
    </tbody>  
</table><div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">acc_condition_1_2</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">open_acc</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">|</span> <span class="n">loan_df</span><span class="o">.</span><span class="n">total_acc</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">((</span><span class="n">loan_df</span><span class="o">.</span><span class="n">open_acc</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">total_acc</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">acc_condition_3_4</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">open_acc</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">|</span> <span class="n">loan_df</span><span class="o">.</span><span class="n">total_acc</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">((</span><span class="n">loan_df</span><span class="o">.</span><span class="n">open_acc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">total_acc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">acc_condition_5</span> <span class="o">=</span> \
    <span class="n">loan_df</span><span class="o">.</span><span class="n">open_acc</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">loan_df</span><span class="o">.</span><span class="n">total_acc</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>

<span class="c1"># Replace total open acc as 0</span>
<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">acc_condition_1_2</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;open_acc&#39;</span><span class="p">,</span> <span class="s1">&#39;total_acc&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>open_acc</th>
      <th>total_acc</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop the observations</span>
<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">acc_condition_3_4</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;open_acc&#39;</span><span class="p">,</span> <span class="s1">&#39;total_acc&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>open_acc</th>
      <th>total_acc</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Preferably drop the observations that doesn&#39;t meet policy</span>
<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">acc_condition_5</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;open_acc&#39;</span><span class="p">,</span> <span class="s1">&#39;total_acc&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># length = 29</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>open_acc</th>
      <th>total_acc</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>42449</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42450</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42459</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42472</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42480</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">total_cur_bal</span></code> is linked with <code class="docutils literal notranslate"><span class="pre">total_open_acc</span></code>. Missing <code class="docutils literal notranslate"><span class="pre">total_cur_bal</span></code> while <code class="docutils literal notranslate"><span class="pre">total_open_acc</span></code> &gt; 0 (and vice versa) is ambiguous.</p></li>
</ul>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>Condition</th>
      <th>total_open_acc</th>
      <th>total_cur_bal</th>
      <th>Remarks</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</th>
      <td>NaN</th>
      <td>0</td>
      <td>Structurally Missing</td>
    </tr>
    <tr>
      <td>2</th>
      <td>0</th>
      <td>NaN</td>
      <td>Structurally Missing</td>
    </tr>
    <tr>
      <td>3</th>
      <td>NaN</th>
      <td>>0</td>
      <td>MCAR</td>
    </tr>
    <tr>
      <td>4</th>
      <td>>0</th>
      <td>NaN</td>
      <td>MCAR</td>
    </tr>
    <tr>
      <td>5</th>
      <td>NaN</th>
      <td>NaN</td>
      <td>MNAR</td>
    </tr>
    </tbody>  
</table><div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bal_condition_1_2</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">tot_cur_bal</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">|</span> <span class="n">loan_df</span><span class="o">.</span><span class="n">total_acc</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">((</span><span class="n">loan_df</span><span class="o">.</span><span class="n">tot_cur_bal</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">total_acc</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">bal_condition_3_4</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">tot_cur_bal</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">|</span> <span class="n">loan_df</span><span class="o">.</span><span class="n">total_acc</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">((</span><span class="n">loan_df</span><span class="o">.</span><span class="n">tot_cur_bal</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">total_acc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">bal_condition_5</span> <span class="o">=</span> \
    <span class="n">loan_df</span><span class="o">.</span><span class="n">tot_cur_bal</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">loan_df</span><span class="o">.</span><span class="n">total_acc</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>

<span class="c1"># Replace as 0</span>
<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">bal_condition_1_2</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;tot_cur_bal&#39;</span><span class="p">,</span> <span class="s1">&#39;total_acc&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tot_cur_bal</th>
      <th>total_acc</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># drop the observations</span>
<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">bal_condition_3_4</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;tot_cur_bal&#39;</span><span class="p">,</span> <span class="s1">&#39;total_acc&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1"># drop</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tot_cur_bal</th>
      <th>total_acc</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>9.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>4.00</td>
      <td>Charged Off</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>10.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>37.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>38.00</td>
      <td>Current</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Preferably drop the observations</span>
<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">bal_condition_5</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;tot_cur_bal&#39;</span><span class="p">,</span> <span class="s1">&#39;total_acc&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1"># length = 29</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tot_cur_bal</th>
      <th>total_acc</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>42449</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42450</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42459</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42472</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42480</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">total_coll_amnt</span></code> is linked with <code class="docutils literal notranslate"><span class="pre">collections_12_mnths_ex_med</span></code>. Missing <code class="docutils literal notranslate"><span class="pre">total_cur_bal</span></code> while <code class="docutils literal notranslate"><span class="pre">total_open_acc</span></code> &gt; 0 (and vice versa) is ambiguous.</p></li>
</ul>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>Condition</th>
      <th>total_coll_amnt</th>
      <th>collections_12_mnths_ex_med</th>
      <th>Remarks</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</th>
      <td>NaN</th>
      <td>NaN</td>
      <td>MNAR</td>
    </tr>
    <tr>
      <td>2</th>
      <td>0</th>
      <td>NaN</td>
      <td>Structurally Missing</td>
    </tr>
      <tr>
      <td>3</th>
      <td>NaN</th>
      <td>0</td>
      <td>Structurally Missing</td>
    </tr>
    <tr>
      <td>4</th>
      <td>NaN</th>
      <td>>0</td>
      <td>MCAR</td>
    </tr>
    <tr>
      <td>5</th>
      <td>>0</th>
      <td>NaN</td>
      <td>MCAR</td>
    </tr>
    </tbody>  
</table><div class="cell tag_hide-input tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coll_condition_1</span> <span class="o">=</span> \
    <span class="n">loan_df</span><span class="o">.</span><span class="n">tot_coll_amt</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">loan_df</span><span class="o">.</span><span class="n">collections_12_mths_ex_med</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="n">coll_condition_2_3</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">tot_coll_amt</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">|</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">tot_coll_amt</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">collections_12_mths_ex_med</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">|</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">collections_12_mths_ex_med</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">coll_condition_4</span> <span class="o">=</span> \
    <span class="n">loan_df</span><span class="o">.</span><span class="n">tot_coll_amt</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">collections_12_mths_ex_med</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">coll_condition_5</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">tot_coll_amt</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">collections_12_mths_ex_med</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>

<span class="c1"># Drop observations</span>
<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">coll_condition_1</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;tot_coll_amt&#39;</span><span class="p">,</span> <span class="s1">&#39;collections_12_mths_ex_med&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tot_coll_amt</th>
      <th>collections_12_mths_ex_med</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>39698</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>39711</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>39719</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>39728</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>39729</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>42530</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42531</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42532</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42533</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>42534</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
  </tbody>
</table>
<p>145 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Replace as 0</span>
<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">coll_condition_2_3</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;tot_coll_amt&#39;</span><span class="p">,</span> <span class="s1">&#39;collections_12_mths_ex_med&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tot_coll_amt</th>
      <th>collections_12_mths_ex_med</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>Charged Off</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>887373</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>887374</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>887375</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>887376</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>887378</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>Current</td>
    </tr>
  </tbody>
</table>
<p>768510 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop the observations</span>
<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">coll_condition_4</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;tot_coll_amt&#39;</span><span class="p">,</span> <span class="s1">&#39;collections_12_mths_ex_med&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tot_coll_amt</th>
      <th>collections_12_mths_ex_med</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop the observations</span>
<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">coll_condition_5</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;tot_coll_amt&#39;</span><span class="p">,</span> <span class="s1">&#39;collections_12_mths_ex_med&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tot_coll_amt</th>
      <th>collections_12_mths_ex_med</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">open_il_12m</span></code>, <code class="docutils literal notranslate"><span class="pre">open_il_24m</span></code>, <code class="docutils literal notranslate"><span class="pre">mnths_since_rcnt_il</span></code> are linked with <code class="docutils literal notranslate"><span class="pre">total_bal_il</span></code>.</p></li>
</ul>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>Condition</th>
      <th>open_il_12m</th>
      <th>open_il_24m</th>
      <th>mnths_since_rcnt_il</th>
      <th>total_bal_il</th>
      <th>Remarks</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</th>
      <td>NaN</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>Structurally Missing</td>
    </tr>
    <tr>
      <td>2</th>
      <td>NaN</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>>0</td>
      <td>MCAR</td>
    </tr>
    <tr>
      <td>3</th>
      <td>>0</th>
      <td>>0</td>
      <td>NaN</td>
      <td>>0</td>
      <td>MAR, should be 1</td>
    </tr>
    <tr>
      <td>4</th>
      <td>NaN</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>MNAR (majority), assume Structurally Missing</td>
    </tr>
    </tbody>  
</table><div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">open_il_condition_1</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">open_il_12m</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">|</span> <span class="n">loan_df</span><span class="o">.</span><span class="n">open_il_24m</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">mths_since_rcnt_il</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">total_bal_il</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">open_il_condition_2</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">open_il_12m</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">|</span> <span class="n">loan_df</span><span class="o">.</span><span class="n">open_il_24m</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">mths_since_rcnt_il</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">total_bal_il</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">open_il_condition_3</span> <span class="o">=</span> \
    <span class="p">((</span><span class="n">loan_df</span><span class="o">.</span><span class="n">open_il_12m</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">open_il_24m</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">mths_since_rcnt_il</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">total_bal_il</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">open_il_condition_4</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">open_il_12m</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">loan_df</span><span class="o">.</span><span class="n">open_il_24m</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">mths_since_rcnt_il</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">total_bal_il</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">open_il_condition_1</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;open_il_12m&#39;</span><span class="p">,</span> <span class="s1">&#39;open_il_24m&#39;</span><span class="p">,</span> <span class="s1">&#39;mths_since_rcnt_il&#39;</span><span class="p">,</span> <span class="s1">&#39;total_bal_il&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>open_il_12m</th>
      <th>open_il_24m</th>
      <th>mths_since_rcnt_il</th>
      <th>total_bal_il</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">open_il_condition_2</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;open_il_12m&#39;</span><span class="p">,</span> <span class="s1">&#39;open_il_24m&#39;</span><span class="p">,</span> <span class="s1">&#39;mths_since_rcnt_il&#39;</span><span class="p">,</span> <span class="s1">&#39;total_bal_il&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>open_il_12m</th>
      <th>open_il_24m</th>
      <th>mths_since_rcnt_il</th>
      <th>total_bal_il</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">open_il_condition_3</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;open_il_12m&#39;</span><span class="p">,</span> <span class="s1">&#39;open_il_24m&#39;</span><span class="p">,</span> <span class="s1">&#39;mths_since_rcnt_il&#39;</span><span class="p">,</span> <span class="s1">&#39;total_bal_il&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>open_il_12m</th>
      <th>open_il_24m</th>
      <th>mths_since_rcnt_il</th>
      <th>total_bal_il</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">open_il_condition_4</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;open_il_12m&#39;</span><span class="p">,</span> <span class="s1">&#39;open_il_24m&#39;</span><span class="p">,</span> <span class="s1">&#39;mths_since_rcnt_il&#39;</span><span class="p">,</span> <span class="s1">&#39;total_bal_il&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>open_il_12m</th>
      <th>open_il_24m</th>
      <th>mths_since_rcnt_il</th>
      <th>total_bal_il</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Charged Off</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>887374</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>887375</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>887376</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>887377</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>887378</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
  </tbody>
</table>
<p>866007 rows × 5 columns</p>
</div></div></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Majority of installment features has missing value for all of the related features. We will assume this as Structurally Missing. 
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">total_bal_il</span></code> is linked with <code class="docutils literal notranslate"><span class="pre">il_util</span></code>. Note that utilization ratio is the ratio of current debt that has been paid, missing <code class="docutils literal notranslate"><span class="pre">total_bal_il</span></code> while <code class="docutils literal notranslate"><span class="pre">il_util</span></code> &gt; 0 (and vice versa) is ambiguous.</p></li>
</ul>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>Condition</th>
      <th>total_bal_il</th>
      <th>il_util</th>
      <th>Remarks</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</th>
      <td>>0</th>
      <td>NaN</td>
      <td>MCAR</td>
    </tr>
      <tr>
      <td>2</th>
      <td>NaN</th>
      <td>>0</td>
      <td>MCAR</td>
    </tr>
    <tr>
      <td>3</th>
      <td>NaN</th>
      <td>0</td>
      <td>MAR</td>
    </tr>
    <tr>
      <td>4</th>
      <td>0</th>
      <td>NaN</td>
      <td>MAR</td>
    <tr>
      <td>5</th>
      <td>NaN</th>
      <td>NaN</td>
      <td>MNAR (majority), assumes Structurally Missing</td>
    </tr>
    </tr>
    </tbody>  
</table><div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bal_il_condition_1</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">total_bal_il</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">il_util</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>
<span class="n">bal_il_condition_2</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">total_bal_il</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">il_util</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">bal_il_condition_3</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">total_bal_il</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">il_util</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">bal_il_condition_4</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">total_bal_il</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">il_util</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>
<span class="n">bal_il_condition_5</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">total_bal_il</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">il_util</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>

<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">bal_il_condition_1</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;total_bal_il&#39;</span><span class="p">,</span> <span class="s1">&#39;il_util&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bal_il</th>
      <th>il_util</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>466294</th>
      <td>55536.00</td>
      <td>NaN</td>
      <td>Issued</td>
    </tr>
    <tr>
      <th>466340</th>
      <td>352033.00</td>
      <td>NaN</td>
      <td>Issued</td>
    </tr>
    <tr>
      <th>466382</th>
      <td>14477.00</td>
      <td>NaN</td>
      <td>Issued</td>
    </tr>
    <tr>
      <th>466455</th>
      <td>42475.00</td>
      <td>NaN</td>
      <td>Issued</td>
    </tr>
    <tr>
      <th>466465</th>
      <td>32185.00</td>
      <td>NaN</td>
      <td>Issued</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>488400</th>
      <td>77148.00</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>488417</th>
      <td>30531.00</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>488470</th>
      <td>21331.00</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>488527</th>
      <td>17718.00</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>489014</th>
      <td>41039.00</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
  </tbody>
</table>
<p>633 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">bal_il_condition_2</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;total_bal_il&#39;</span><span class="p">,</span> <span class="s1">&#39;il_util&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bal_il</th>
      <th>il_util</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">bal_il_condition_3</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;total_bal_il&#39;</span><span class="p">,</span> <span class="s1">&#39;il_util&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bal_il</th>
      <th>il_util</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">bal_il_condition_4</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;total_bal_il&#39;</span><span class="p">,</span> <span class="s1">&#39;il_util&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bal_il</th>
      <th>il_util</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>466301</th>
      <td>0.00</td>
      <td>NaN</td>
      <td>Issued</td>
    </tr>
    <tr>
      <th>466330</th>
      <td>0.00</td>
      <td>NaN</td>
      <td>Issued</td>
    </tr>
    <tr>
      <th>466338</th>
      <td>0.00</td>
      <td>NaN</td>
      <td>Issued</td>
    </tr>
    <tr>
      <th>466352</th>
      <td>0.00</td>
      <td>NaN</td>
      <td>Issued</td>
    </tr>
    <tr>
      <th>466366</th>
      <td>0.00</td>
      <td>NaN</td>
      <td>Issued</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>488962</th>
      <td>0.00</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>489026</th>
      <td>0.00</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>489059</th>
      <td>0.00</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>489092</th>
      <td>0.00</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>489160</th>
      <td>0.00</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
  </tbody>
</table>
<p>2122 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">bal_il_condition_5</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;total_bal_il&#39;</span><span class="p">,</span> <span class="s1">&#39;il_util&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bal_il</th>
      <th>il_util</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Charged Off</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>887374</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>887375</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>887376</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>887377</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>887378</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
  </tbody>
</table>
<p>866007 rows × 3 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">revol_bal</span></code> is linked with <code class="docutils literal notranslate"><span class="pre">revol_util</span></code>. Missing <code class="docutils literal notranslate"><span class="pre">revol_bal</span></code> while <code class="docutils literal notranslate"><span class="pre">revol_util</span></code> &gt; 0 (and vice versa) is ambiguous.</p></li>
</ul>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>Condition</th>
      <th>revol_bal</th>
      <th>revol_util</th>
      <th>Remarks</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</th>
      <td>>0</th>
      <td>NaN</td>
      <td>MCAR</td>
    </tr>
      <tr>
      <td>2</th>
      <td>NaN</th>
      <td>>0</td>
      <td>MCAR</td>
    </tr>
    <tr>
      <td>3</th>
      <td>NaN</th>
      <td>0</td>
      <td>MAR</td>
    </tr>
    <tr>
      <td>4</th>
      <td>0</th>
      <td>NaN</td>
      <td>MAR</td>
    <tr>
      <td>5</th>
      <td>NaN</th>
      <td>NaN</td>
      <td>MNAR (majority), assumes Structurally Missing</td>
    </tr>
    </tr>
    </tbody>  
</table><div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">revol_condition_1</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">revol_bal</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">revol_util</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>
<span class="n">revol_condition_2</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">revol_bal</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">revol_util</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">revol_condition_3</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">revol_bal</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">revol_util</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">revol_condition_4</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">revol_bal</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">revol_util</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>
<span class="n">revol_condition_5</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">revol_bal</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>\
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">loan_df</span><span class="o">.</span><span class="n">revol_util</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>

<span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">revol_condition_1</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;revol_bal&#39;</span><span class="p">,</span> <span class="s1">&#39;revol_util&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>revol_bal</th>
      <th>revol_util</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>37609</th>
      <td>49238.00</td>
      <td>NaN</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>41175</th>
      <td>290291.00</td>
      <td>NaN</td>
      <td>Does not meet the credit policy. Status:Fully ...</td>
    </tr>
    <tr>
      <th>49606</th>
      <td>1545.00</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>52145</th>
      <td>2028.00</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>78172</th>
      <td>15304.00</td>
      <td>NaN</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>843957</th>
      <td>24904.00</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>848280</th>
      <td>40156.00</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>869440</th>
      <td>62918.00</td>
      <td>NaN</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>872237</th>
      <td>3671.00</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>883171</th>
      <td>91109.00</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
  </tbody>
</table>
<p>99 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">revol_condition_2</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;revol_bal&#39;</span><span class="p">,</span> <span class="s1">&#39;revol_util&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>revol_bal</th>
      <th>revol_util</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">revol_condition_3</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;revol_bal&#39;</span><span class="p">,</span> <span class="s1">&#39;revol_util&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>revol_bal</th>
      <th>revol_util</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">revol_condition_4</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;revol_bal&#39;</span><span class="p">,</span> <span class="s1">&#39;revol_util&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>revol_bal</th>
      <th>revol_util</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3577</th>
      <td>0.00</td>
      <td>NaN</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>4730</th>
      <td>0.00</td>
      <td>NaN</td>
      <td>Charged Off</td>
    </tr>
    <tr>
      <th>4960</th>
      <td>0.00</td>
      <td>NaN</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>11315</th>
      <td>0.00</td>
      <td>NaN</td>
      <td>Fully Paid</td>
    </tr>
    <tr>
      <th>12076</th>
      <td>0.00</td>
      <td>NaN</td>
      <td>Charged Off</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>869207</th>
      <td>0.00</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>883031</th>
      <td>0.00</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>883102</th>
      <td>0.00</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
    <tr>
      <th>884401</th>
      <td>0.00</td>
      <td>NaN</td>
      <td>Late (31-120 days)</td>
    </tr>
    <tr>
      <th>887229</th>
      <td>0.00</td>
      <td>NaN</td>
      <td>Current</td>
    </tr>
  </tbody>
</table>
<p>403 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">revol_condition_5</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;revol_bal&#39;</span><span class="p">,</span> <span class="s1">&#39;revol_util&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>revol_bal</th>
      <th>revol_util</th>
      <th>loan_status</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<p>For other features that has no counterpart, will be assumed as Structurally Missing.</p>
<p>So, the missing value remedies has the flow: 1) first we check each of the condition above, replace the missing value accordingly; 2) For other missing value that exist (outside of the previous conditions), assume as Structurally Missing, replace either with 1 or 300 (for months_since_).</p>
</section>
<section id="loan-profile">
<h3><strong>Loan Profile</strong><a class="headerlink" href="#loan-profile" title="Permalink to this headline">#</a></h3>
<p>For <em>Loan Profile</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_exploration</span><span class="o">.</span><span class="n">show_nans_or_zeroes</span><span class="p">(</span><span class="s1">&#39;nans&#39;</span><span class="p">,</span> <span class="n">loan_features</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Nans Count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Nans Count</th>
      <th>Nans Percentage (%)</th>
      <th>Data Types</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>desc</th>
      <td>761351</td>
      <td>85.80</td>
      <td>object</td>
    </tr>
    <tr>
      <th>title</th>
      <td>152</td>
      <td>0.02</td>
      <td>object</td>
    </tr>
    <tr>
      <th>id</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>loan_amnt</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>term</th>
      <td>0</td>
      <td>0.00</td>
      <td>category</td>
    </tr>
    <tr>
      <th>int_rate</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>installment</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>grade</th>
      <td>0</td>
      <td>0.00</td>
      <td>category</td>
    </tr>
    <tr>
      <th>sub_grade</th>
      <td>0</td>
      <td>0.00</td>
      <td>category</td>
    </tr>
    <tr>
      <th>pymnt_plan</th>
      <td>0</td>
      <td>0.00</td>
      <td>category</td>
    </tr>
    <tr>
      <th>purpose</th>
      <td>0</td>
      <td>0.00</td>
      <td>category</td>
    </tr>
    <tr>
      <th>zip_code</th>
      <td>0</td>
      <td>0.00</td>
      <td>object</td>
    </tr>
    <tr>
      <th>addr_state</th>
      <td>0</td>
      <td>0.00</td>
      <td>object</td>
    </tr>
    <tr>
      <th>policy_code</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>application_type</th>
      <td>0</td>
      <td>0.00</td>
      <td>category</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Type of missing data is MNAR: <code class="docutils literal notranslate"><span class="pre">desc</span></code>, <code class="docutils literal notranslate"><span class="pre">title</span></code>. These features won’t be used for machine learning features.</p>
</section>
<section id="creating-the-processor-class">
<h3><strong>Creating the Processor Class</strong><a class="headerlink" href="#creating-the-processor-class" title="Permalink to this headline">#</a></h3>
<p>Class <code class="docutils literal notranslate"><span class="pre">LoanDataMissingHandler()</span></code> has been developed to handle missing value for LoanData.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">modules.data_preprocess</span> <span class="kn">import</span> <span class="n">LoanDataMissingHandler</span>

<span class="n">missing_handler</span> <span class="o">=</span> <span class="n">LoanDataMissingHandler</span><span class="p">()</span>
<span class="n">loan_df</span> <span class="o">=</span> <span class="n">missing_handler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">loan_df</span><span class="p">)</span>
<span class="n">data_exploration</span> <span class="o">=</span> <span class="n">DataExploration</span><span class="p">(</span><span class="n">loan_df</span><span class="p">)</span>
<span class="n">data_exploration</span><span class="o">.</span><span class="n">show_nans_or_zeroes</span><span class="p">(</span><span class="s1">&#39;nans&#39;</span><span class="p">,</span> <span class="n">applicant_features</span> <span class="o">+</span> <span class="n">loan_features</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Nans Count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Nans Count</th>
      <th>Nans Percentage (%)</th>
      <th>Data Types</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>dti_joint</th>
      <td>815877</td>
      <td>99.94</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>verification_status_joint</th>
      <td>815875</td>
      <td>99.94</td>
      <td>category</td>
    </tr>
    <tr>
      <th>annual_inc_joint</th>
      <td>815875</td>
      <td>99.94</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>desc</th>
      <td>736690</td>
      <td>90.24</td>
      <td>object</td>
    </tr>
    <tr>
      <th>emp_title</th>
      <td>47084</td>
      <td>5.77</td>
      <td>object</td>
    </tr>
    <tr>
      <th>emp_length</th>
      <td>42723</td>
      <td>5.23</td>
      <td>category</td>
    </tr>
    <tr>
      <th>title</th>
      <td>136</td>
      <td>0.02</td>
      <td>object</td>
    </tr>
    <tr>
      <th>member_id</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>max_bal_bc</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>open_rv_24m</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>all_util</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>total_rev_hi_lim</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>inq_fi</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>total_cu_tl</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>inq_last_12m</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>pub_rec</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>loan_amnt</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>id</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>il_util</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>term</th>
      <td>0</td>
      <td>0.00</td>
      <td>category</td>
    </tr>
    <tr>
      <th>int_rate</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>installment</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>grade</th>
      <td>0</td>
      <td>0.00</td>
      <td>category</td>
    </tr>
    <tr>
      <th>sub_grade</th>
      <td>0</td>
      <td>0.00</td>
      <td>category</td>
    </tr>
    <tr>
      <th>pymnt_plan</th>
      <td>0</td>
      <td>0.00</td>
      <td>category</td>
    </tr>
    <tr>
      <th>purpose</th>
      <td>0</td>
      <td>0.00</td>
      <td>category</td>
    </tr>
    <tr>
      <th>zip_code</th>
      <td>0</td>
      <td>0.00</td>
      <td>object</td>
    </tr>
    <tr>
      <th>addr_state</th>
      <td>0</td>
      <td>0.00</td>
      <td>object</td>
    </tr>
    <tr>
      <th>policy_code</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>open_rv_12m</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>open_il_24m</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>total_bal_il</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>mths_since_rcnt_il</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>home_ownership</th>
      <td>0</td>
      <td>0.00</td>
      <td>category</td>
    </tr>
    <tr>
      <th>annual_inc</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>verification_status</th>
      <td>0</td>
      <td>0.00</td>
      <td>category</td>
    </tr>
    <tr>
      <th>dti</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>delinq_2yrs</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>earliest_cr_line</th>
      <td>0</td>
      <td>0.00</td>
      <td>datetime64[ns]</td>
    </tr>
    <tr>
      <th>inq_last_6mths</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>mths_since_last_delinq</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>mths_since_last_record</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>open_acc</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>revol_bal</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>revol_util</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>total_acc</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>collections_12_mths_ex_med</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>mths_since_last_major_derog</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>policy_code</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>acc_now_delinq</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>tot_coll_amt</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>tot_cur_bal</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>open_acc_6m</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>open_il_12m</th>
      <td>0</td>
      <td>0.00</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>application_type</th>
      <td>0</td>
      <td>0.00</td>
      <td>category</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><a id="skip_to_cardinality"> </a></p>
</section>
<section id="cardinality-of-data-fields-containing-objects-datatype">
<h3><strong>2.2 Cardinality of data fields containing <em>Objects</em> datatype</strong><a class="headerlink" href="#cardinality-of-data-fields-containing-objects-datatype" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obj_columns</span> <span class="o">=</span> <span class="n">loan_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>

<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">obj_columns</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Column: </span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s1">, Unique Values: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">loan_df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column: emp_title, Unique Values: 250467
Column: desc, Unique Values: 78434
Column: title, Unique Values: 37805
Column: zip_code, Unique Values: 932
Column: addr_state, Unique Values: 51
</pre></div>
</div>
</div>
</div>
<p>Data fields with <code class="docutils literal notranslate"><span class="pre">object</span></code> datatype, which have high cardinality, won’t be used as machine learning features. Nevertheless, statistics related to those datafields will be shown for exploratory analysis to gather valuable insight. Later we will use <em>word clouds</em> as a representation of these observations.</p>
</section>
<section id="takeaway">
<h3><strong>Takeaway</strong><a class="headerlink" href="#takeaway" title="Permalink to this headline">#</a></h3>
<p>Based on explanation above, we will consider <strong>applicant’s profile</strong> and <strong>loan profile</strong> for our prediction model. However, we will explore more whether we can extract some features from <strong>post-originated loan data</strong>. Features related to <em>date and time</em> will also be considered in feature extraction.</p>
<p>Below list consists the features that will be dropped due to its cardinality. And note that we only consider <code class="docutils literal notranslate"><span class="pre">INDIVIDUAL</span></code> type loan.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loan_df</span> <span class="o">=</span> <span class="n">loan_df</span><span class="p">[</span><span class="n">loan_df</span><span class="o">.</span><span class="n">application_type</span> <span class="o">==</span> <span class="s1">&#39;INDIVIDUAL&#39;</span><span class="p">]</span>
<span class="n">drop_features</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;emp_title&#39;</span><span class="p">,</span> <span class="s1">&#39;desc&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;zip_code&#39;</span><span class="p">,</span> <span class="s1">&#39;addr_state&#39;</span><span class="p">,</span> <span class="s1">&#39;application_type&#39;</span><span class="p">,</span>
    <span class="s1">&#39;dti_joint&#39;</span><span class="p">,</span> <span class="s1">&#39;annual_inc_joint&#39;</span><span class="p">,</span> <span class="s1">&#39;verification_status_joint&#39;</span>
    <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="exploratory-data-analytics">
<h2>3. Exploratory Data Analytics<a class="headerlink" href="#exploratory-data-analytics" title="Permalink to this headline">#</a></h2>
<section id="categorical-data">
<h3>3.1. Categorical Data<a class="headerlink" href="#categorical-data" title="Permalink to this headline">#</a></h3>
<p>Analyzing categorical data gives us general understanding of the Lending Club dataset, especially about the loan status that implies general outcome of this Lending Club credit business. Summary statistics for our categorical data is shown as below:</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loan_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>term</th>
      <th>grade</th>
      <th>sub_grade</th>
      <th>emp_title</th>
      <th>emp_length</th>
      <th>home_ownership</th>
      <th>verification_status</th>
      <th>loan_status</th>
      <th>pymnt_plan</th>
      <th>desc</th>
      <th>purpose</th>
      <th>title</th>
      <th>zip_code</th>
      <th>addr_state</th>
      <th>initial_list_status</th>
      <th>application_type</th>
      <th>verification_status_joint</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>815875</td>
      <td>815875</td>
      <td>815875</td>
      <td>768850</td>
      <td>773211</td>
      <td>815875</td>
      <td>815875</td>
      <td>815875</td>
      <td>815875</td>
      <td>79687</td>
      <td>815875</td>
      <td>815747</td>
      <td>815875</td>
      <td>815875</td>
      <td>815875</td>
      <td>815875</td>
      <td>0</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>2</td>
      <td>7</td>
      <td>35</td>
      <td>250363</td>
      <td>11</td>
      <td>6</td>
      <td>3</td>
      <td>8</td>
      <td>2</td>
      <td>78433</td>
      <td>14</td>
      <td>37804</td>
      <td>932</td>
      <td>51</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>top</th>
      <td>36 months</td>
      <td>B</td>
      <td>B4</td>
      <td>Teacher</td>
      <td>10+ years</td>
      <td>MORTGAGE</td>
      <td>Source Verified</td>
      <td>Current</td>
      <td>n</td>
      <td></td>
      <td>debt_consolidation</td>
      <td>Debt consolidation</td>
      <td>945xx</td>
      <td>CA</td>
      <td>w</td>
      <td>INDIVIDUAL</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>566300</td>
      <td>232453</td>
      <td>51106</td>
      <td>13782</td>
      <td>274255</td>
      <td>411574</td>
      <td>311262</td>
      <td>597307</td>
      <td>815869</td>
      <td>20</td>
      <td>488500</td>
      <td>411797</td>
      <td>8848</td>
      <td>117061</td>
      <td>429583</td>
      <td>815875</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="loan-status">
<h4><strong>Loan Status</strong><a class="headerlink" href="#loan-status" title="Permalink to this headline">#</a></h4>
<p>Feature <code class="docutils literal notranslate"><span class="pre">loan_status</span></code> is the possible features as a target of supervised learning to predict whether particular loan is good or bad. This feature records is available after the loan is originated to the applicant.</p>
<ul class="simple">
<li><p>Loan that is not yet started: <code class="docutils literal notranslate"><span class="pre">Issued</span></code>.</p></li>
<li><p>On-going loan has status: <code class="docutils literal notranslate"><span class="pre">Current</span></code>, <code class="docutils literal notranslate"><span class="pre">Late</span></code>, and <code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">Grace</span> <span class="pre">Period</span></code>.</p></li>
<li><p>Finished loan has status either <code class="docutils literal notranslate"><span class="pre">Fully</span> <span class="pre">Paid</span></code>, <code class="docutils literal notranslate"><span class="pre">Charged</span> <span class="pre">Off</span></code>, and <code class="docutils literal notranslate"><span class="pre">Default</span></code>.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="c1"># df for plotting count</span>
<span class="n">plot_count</span> <span class="o">=</span> <span class="n">loan_df</span>\
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;loan_status&#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">counts</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;loan_status&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">))</span>\
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;counts&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># plot</span>
<span class="n">red</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;colorblind&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span>
<span class="n">blue</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;colorblind&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">green</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;colorblind&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">blue</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">red</span><span class="p">,</span> <span class="n">red</span><span class="p">,</span> <span class="n">blue</span><span class="p">,</span> 
    <span class="n">red</span><span class="p">,</span> <span class="n">red</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">red</span><span class="p">,</span> <span class="n">red</span> 
    <span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">plot_count</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;counts&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;loan_status&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">plot_count</span><span class="o">.</span><span class="n">loan_status</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span>
    <span class="p">)</span>
<span class="k">for</span> <span class="n">y_</span><span class="p">,</span> <span class="n">x_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plot_count</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">x_</span> <span class="o">+</span> <span class="mi">2000</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">y_</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x_</span><span class="si">:</span><span class="s1">,.0f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span>
    <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Categories of Loan Status&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">650000</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2_Data_exploration_80_0.png" src="_images/2_Data_exploration_80_0.png" />
</div>
</div>
<p>Most of the loan listed in our dataset is on-going loan (<code class="docutils literal notranslate"><span class="pre">loan_status</span></code> = <code class="docutils literal notranslate"><span class="pre">Current</span></code>). However, we can identify some loan that faces some difficulties in paying-off debt on the due date: <code class="docutils literal notranslate"><span class="pre">Late</span></code> and <code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">Grace</span> <span class="pre">Period</span></code>.</p>
<p>To make an easier representation of <code class="docutils literal notranslate"><span class="pre">loan_status</span></code>, we will create a new feature to label the loan as <code class="docutils literal notranslate"><span class="pre">Good</span> <span class="pre">Loan</span></code> and <code class="docutils literal notranslate"><span class="pre">Bad</span> <span class="pre">Loan</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Bad</span> <span class="pre">Loan</span></code> consists of: <code class="docutils literal notranslate"><span class="pre">Charged</span> <span class="pre">Off</span></code>, <code class="docutils literal notranslate"><span class="pre">Default</span></code>, <code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">Grace</span> <span class="pre">Period</span></code>, and <code class="docutils literal notranslate"><span class="pre">Late</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Good</span> <span class="pre">Loan</span></code> consists of: <code class="docutils literal notranslate"><span class="pre">Fully</span> <span class="pre">Paid</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Current</span></code> loan possibly may be a <code class="docutils literal notranslate"><span class="pre">Good</span> <span class="pre">Loan</span></code>, since up to the data recorded the loan seems to not having paying difficulties.</p></li>
</ul>
<p>Ideally we can’t justify the <code class="docutils literal notranslate"><span class="pre">Curent</span> <span class="pre">Loan</span></code> to be either <code class="docutils literal notranslate"><span class="pre">Good</span> <span class="pre">Loan</span></code> or <code class="docutils literal notranslate"><span class="pre">Bad</span> <span class="pre">Loan</span></code> since it is highly subjective and maybe introducing biases to our dataset.</p>
<p>However, there may be a pattern of <code class="docutils literal notranslate"><span class="pre">Current</span> <span class="pre">Loan</span></code> to be defaulted. For example, we can analyze tendencies of defaulted loan by its <code class="docutils literal notranslate"><span class="pre">Portion</span> <span class="pre">of</span> <span class="pre">Loan</span> <span class="pre">Amount</span> <span class="pre">that</span> <span class="pre">has</span> <span class="pre">been</span> <span class="pre">paid</span></code>. We can extract this from <code class="docutils literal notranslate"><span class="pre">total_rec_prncp</span></code> as a portion of <code class="docutils literal notranslate"><span class="pre">loan_amnt</span></code> (recall that <code class="docutils literal notranslate"><span class="pre">total_rec_prncp</span></code> is <em>principal received to date</em>).</p>
<p>Let’s see the distribution of portion of loan paid of <code class="docutils literal notranslate"><span class="pre">Late</span></code>, <code class="docutils literal notranslate"><span class="pre">Default</span></code> and <code class="docutils literal notranslate"><span class="pre">Charged</span> <span class="pre">Off</span></code> status:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bad_loan</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Charged Off&#39;</span><span class="p">,</span> <span class="s1">&#39;Late (31-120 days)&#39;</span><span class="p">,</span> <span class="s1">&#39;In Grace Period&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Late (16-30 days)&#39;</span><span class="p">,</span> <span class="s1">&#39;Default&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Does not meet the credit policy. Status:Charged Off&#39;</span>
    <span class="p">]</span>
<span class="n">plot_bad_loan</span> <span class="o">=</span> <span class="n">loan_df</span><span class="p">[</span><span class="n">loan_df</span><span class="o">.</span><span class="n">loan_status</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">bad_loan</span><span class="p">)]</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">portion_paid</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">total_rec_prncp</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">loan_amnt</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="p">)</span>
<span class="n">plot_bad_loan</span> <span class="o">=</span> <span class="n">plot_bad_loan</span><span class="p">[[</span><span class="s1">&#39;portion_paid&#39;</span><span class="p">]]</span>
<span class="c1"># plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">plot_bad_loan</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;portion_paid&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">red</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Portion of Principal Loan Paid, %&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Principal of Loan Paid, Bad Loan&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Principal of Loan Paid, Bad Loan&#39;)
</pre></div>
</div>
<img alt="_images/2_Data_exploration_82_1.png" src="_images/2_Data_exploration_82_1.png" />
</div>
</div>
<p>From above plot, the distribution of <code class="docutils literal notranslate"><span class="pre">Bad</span> <span class="pre">Loan</span></code> is proportionally lower for higher <code class="docutils literal notranslate"><span class="pre">Portion</span> <span class="pre">of</span> <span class="pre">Loan</span> <span class="pre">Paid</span></code>. This indicate that, by data, <em>the chance is smaller for loan to be defaulted after large portion of principal has been paid</em>.</p>
<p>Since the <code class="docutils literal notranslate"><span class="pre">Good</span> <span class="pre">Loan</span></code> has more occasion than <code class="docutils literal notranslate"><span class="pre">Bad</span> <span class="pre">Loan</span></code>, we can, if necessary, consider <code class="docutils literal notranslate"><span class="pre">Current</span> <span class="pre">Loan</span></code> as a <code class="docutils literal notranslate"><span class="pre">Good</span> <span class="pre">Loan</span></code> only if the loan is close to be fully paid, specifically when the <code class="docutils literal notranslate"><span class="pre">total_rec_prncp</span></code> <span class="math notranslate nohighlight">\(\geq\)</span> <code class="docutils literal notranslate"><span class="pre">%</span></code> portion of <code class="docutils literal notranslate"><span class="pre">loan_amnt</span></code>. But adding more observations to <code class="docutils literal notranslate"><span class="pre">Good</span> <span class="pre">Loan</span></code> lead to more imbalanced data towards the <code class="docutils literal notranslate"><span class="pre">Good</span> <span class="pre">Loan</span></code>.</p>
<p>On the other hand, we are more interested to oversample our <code class="docutils literal notranslate"><span class="pre">Bad</span> <span class="pre">Loan</span></code> to tighten the gap. However, considering <code class="docutils literal notranslate"><span class="pre">Current</span> <span class="pre">Loan</span></code> as a <code class="docutils literal notranslate"><span class="pre">Bad</span> <span class="pre">Loan</span></code>, let’s say for portion of paid loan under <code class="docutils literal notranslate"><span class="pre">20%</span></code>, is very subjective since the <code class="docutils literal notranslate"><span class="pre">Bad</span> <span class="pre">Loan</span></code> isn’t the majority here.</p>
<p>Let’s create a new feature called <code class="docutils literal notranslate"><span class="pre">loan_category</span></code> to classify <code class="docutils literal notranslate"><span class="pre">Good</span> <span class="pre">Loan</span></code> and <code class="docutils literal notranslate"><span class="pre">Bad</span> <span class="pre">Loan</span></code>. Then, we will look at the proportion of each label.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mapping_loan_cat</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Charged Off&#39;</span><span class="p">:</span> <span class="s1">&#39;Bad Loan&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Late (31-120 days)&#39;</span><span class="p">:</span> <span class="s1">&#39;Bad Loan&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;In Grace Period&#39;</span><span class="p">:</span> <span class="s1">&#39;Bad Loan&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Late (16-30 days)&#39;</span><span class="p">:</span> <span class="s1">&#39;Bad Loan&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Default&#39;</span><span class="p">:</span> <span class="s1">&#39;Bad Loan&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Does not meet the credit policy. Status:Charged Off&#39;</span><span class="p">:</span> <span class="s1">&#39;Bad Loan&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Fully Paid&#39;</span><span class="p">:</span> <span class="s1">&#39;Good Loan&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Does not meet the credit policy. Status:Fully Paid&#39;</span><span class="p">:</span> <span class="s1">&#39;Good Loan&#39;</span>
    <span class="p">}</span>

<span class="c1"># loan_cat_vect = np.vectorize(loan_cat)</span>
<span class="n">loan_df</span> <span class="o">=</span> <span class="n">loan_df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">loan_category</span> <span class="o">=</span> <span class="n">loan_df</span><span class="o">.</span><span class="n">loan_status</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">mapping_loan_cat</span><span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">loan_df</span>\
    <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">loan_df</span><span class="o">.</span><span class="n">loan_category</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;Good Loan&#39;</span><span class="p">,</span> <span class="s1">&#39;Bad Loan&#39;</span><span class="p">]),</span> <span class="s1">&#39;loan_category&#39;</span><span class="p">]</span>\
    <span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>\
    <span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">autopct</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%.2f%%</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Percentage of Loan Category&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2_Data_exploration_84_0.png" src="_images/2_Data_exploration_84_0.png" />
</div>
</div>
<p>Imbalanced sample between <code class="docutils literal notranslate"><span class="pre">Good</span> <span class="pre">Loan</span></code> and <code class="docutils literal notranslate"><span class="pre">Bad</span> <span class="pre">Loan</span></code> probably would lead to model with low recall in predicting potentially <code class="docutils literal notranslate"><span class="pre">Bad</span> <span class="pre">Loan</span></code> (false negative occurs more frequent). For credit business, it is more preferable to avoid defaulted loan rather than taking a risk for maximizing loan numbers then hoping succesfull loan will outnumber (in profit) defaulted loan. Action should be taken.</p>
<p>From now on, we will use <code class="docutils literal notranslate"><span class="pre">loan_df</span></code> subset of <code class="docutils literal notranslate"><span class="pre">Good</span> <span class="pre">Loan</span></code> and <code class="docutils literal notranslate"><span class="pre">Bad</span> <span class="pre">Loan</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loan_df_subset</span> <span class="o">=</span> <span class="n">loan_df</span><span class="p">[</span><span class="n">loan_df</span><span class="o">.</span><span class="n">loan_category</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;Good Loan&#39;</span><span class="p">,</span> <span class="s1">&#39;Bad Loan&#39;</span><span class="p">])]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="loan-category-along-time">
<h4><strong>Loan Category Along Time</strong><a class="headerlink" href="#loan-category-along-time" title="Permalink to this headline">#</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aggr_loan_cat</span> <span class="o">=</span> <span class="n">loan_df</span>\
    <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;issue_d&#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">loan_cat_map</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">loan_category</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="s1">&#39;Good Loan&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;Bad Loan&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}))</span>\
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)])</span>\
    <span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;loan_cat_map&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">})</span>\
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1"># plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">color_blue</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">color_orange</span><span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">aggr_loan_cat</span><span class="o">.</span><span class="n">issue_d</span><span class="p">,</span> <span class="n">aggr_loan_cat</span><span class="o">.</span><span class="n">loan_cat_map</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">aggr_loan_cat</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_blue</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;issue_d&#39;</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="s1">&#39;loan_cat_map&#39;</span><span class="p">,</span> <span class="n">y2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Good Loan&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">aggr_loan_cat</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_orange</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;issue_d&#39;</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">y2</span><span class="o">=</span><span class="s1">&#39;loan_cat_map&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bad Loan&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;issue_d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% G</span><span class="s1">ood Loan&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Portion of Good Loan and Bad Loan Over Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower center&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2_Data_exploration_88_0.png" src="_images/2_Data_exploration_88_0.png" />
</div>
</div>
<p>Decreasing portion of good loan may suggest lower loan ecosystem quality over time.</p>
</section>
<section id="loan-grade-by-loan-category">
<h4><strong>Loan Grade by Loan Category</strong><a class="headerlink" href="#loan-grade-by-loan-category" title="Permalink to this headline">#</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="k">def</span> <span class="nf">plot_categorical_count</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">flip</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">left</span> <span class="o">=</span> <span class="n">loan_df_subset</span>\
        <span class="o">.</span><span class="n">value_counts</span><span class="p">([</span><span class="n">category</span><span class="p">,</span> <span class="s1">&#39;loan_category&#39;</span><span class="p">])</span>\
        <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
        <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;counts&#39;</span><span class="p">})</span>
    <span class="n">right</span> <span class="o">=</span> <span class="n">loan_df_subset</span>\
        <span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">category</span><span class="p">)</span>\
        <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
        <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;total_count&#39;</span><span class="p">})</span>
    <span class="n">emp_length_count</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">category</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
        <span class="p">)</span>
    <span class="n">emp_length_count</span> <span class="o">=</span> <span class="n">emp_length_count</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">portion</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">counts</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">total_count</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="p">)</span>
    <span class="c1"># plot</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">flip</span><span class="p">:</span>
        <span class="n">plot_count</span> <span class="o">=</span> <span class="n">emp_length_count</span>\
            <span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">category</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;loan_category&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;counts&#39;</span><span class="p">)</span>\
            <span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span>
        <span class="n">plot_portion</span> <span class="o">=</span> <span class="n">emp_length_count</span>\
            <span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">category</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;loan_category&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;portion&#39;</span><span class="p">)</span>\
            <span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plot_count</span> <span class="o">=</span> <span class="n">emp_length_count</span>\
            <span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">category</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;loan_category&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;counts&#39;</span><span class="p">)</span>\
            <span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span>
        <span class="n">plot_portion</span> <span class="o">=</span> <span class="n">emp_length_count</span>\
            <span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">category</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;loan_category&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;portion&#39;</span><span class="p">)</span>\
            <span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">)</span>
    <span class="n">plot_count</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Good Loan&#39;</span><span class="p">,</span> <span class="s1">&#39;Bad Loan&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">plot_portion</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Good Loan&#39;</span><span class="p">,</span> <span class="s1">&#39;Bad Loan&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">category</span><span class="si">}</span><span class="s1"> by loan_category&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">plot_categorical_count</span><span class="p">(</span><span class="s1">&#39;grade&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2_Data_exploration_91_0.png" src="_images/2_Data_exploration_91_0.png" />
</div>
</div>
<p>Using above code, we generate two chart: left-hand plot is to show comparable <code class="docutils literal notranslate"><span class="pre">counts</span></code> of loan between each <code class="docutils literal notranslate"><span class="pre">grade</span></code> classes, while right-hand plot is to show portion of Good-Bad loan between <code class="docutils literal notranslate"><span class="pre">grade</span></code> classes, scaled to <code class="docutils literal notranslate"><span class="pre">100%</span></code> (normalized).</p>
<p>From the above plot, we can see that, for lower grade, the chance that the loan will be a <code class="docutils literal notranslate"><span class="pre">Good</span> <span class="pre">Loan</span></code> is become more similar than its likeliness to be a <code class="docutils literal notranslate"><span class="pre">Bad</span> <span class="pre">Loan</span></code>. For <code class="docutils literal notranslate"><span class="pre">F</span></code> and <code class="docutils literal notranslate"><span class="pre">G</span></code> Grade, the almost 50-50 percent portion is just like a flipping coin to decide if the loan will be good or bad!</p>
<p>So what is the loan <code class="docutils literal notranslate"><span class="pre">Grade</span></code> actually for the LendingClub Loan Data? Turns out that it is the <em>Ranking</em> according to <em>LendingClub Scoring Model,</em> which analyzes the performance of borrower members taking into account FICO Score, credit attributes, and other application data (See LendingClub website for more detailed information).</p>
<p>Looking at the occurence of <code class="docutils literal notranslate"><span class="pre">Bad</span> <span class="pre">Loan</span></code> on the plot above, is it worth to consider investing on the lower grade loan? Higher risk, higher profit! Lower-graded loan has a higher interest rate:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df for plotting count</span>
<span class="n">avg_int</span> <span class="o">=</span> <span class="n">loan_df_subset</span>\
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;grade&#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">avg_int_rate</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;int_rate&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">))</span>\
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1"># plot</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;rainbow&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">avg_int</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">avg_int</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;avg_int_rate&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;grade&#39;</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span>
    <span class="p">)</span>
<span class="k">for</span> <span class="n">y_</span><span class="p">,</span> <span class="n">x_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">avg_int</span><span class="o">.</span><span class="n">avg_int_rate</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">x_</span> <span class="o">-</span> <span class="mf">2.6</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">y_</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x_</span><span class="si">:</span><span class="s1">,.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span>
    <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Average Interest Rate, Loan Grade&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2_Data_exploration_93_0.png" src="_images/2_Data_exploration_93_0.png" />
</div>
</div>
<p>So how come <em>higher risk, higher profit</em> relate to our investment to lending? The most simple way to explain it by looking at its loan <code class="docutils literal notranslate"><span class="pre">Value</span></code> of an investment unit:</p>
<div class="math notranslate nohighlight">
\[Value=Probability\times\;Return-1\]</div>
<p>For example, the investment of <em>Grade-G</em> loan (<code class="docutils literal notranslate"><span class="pre">1.25x</span></code> return) may be profittable if we can estimate the probability of that particular loan to be a <code class="docutils literal notranslate"><span class="pre">Good</span> <span class="pre">Loan</span></code> for above <code class="docutils literal notranslate"><span class="pre">80%</span></code>.</p>
<p>Furthermore, how much we can expect loan payment if somehow the loan would be defaulted? Below graph shows the <code class="docutils literal notranslate"><span class="pre">Bad</span> <span class="pre">Loan</span></code> average portion of loan paid according to its loan <code class="docutils literal notranslate"><span class="pre">grade</span></code>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loan_df_subset</span> <span class="o">=</span> <span class="n">loan_df_subset</span>\
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">portion_paid</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">total_rec_prncp</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">loan_amnt</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="p">)</span>
<span class="n">avg_portion</span> <span class="o">=</span> <span class="n">loan_df_subset</span>\
    <span class="p">[</span><span class="n">loan_df_subset</span><span class="o">.</span><span class="n">loan_category</span> <span class="o">==</span> <span class="s1">&#39;Bad Loan&#39;</span><span class="p">]</span>\
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;grade&#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">avg_portion_paid</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;portion_paid&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">))</span>\
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># plot</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;rainbow&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">avg_portion</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">avg_portion</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;avg_portion_paid&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;grade&#39;</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span>
    <span class="p">)</span>
<span class="k">for</span> <span class="n">y_</span><span class="p">,</span> <span class="n">x_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">avg_portion</span><span class="o">.</span><span class="n">avg_portion_paid</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">x_</span> <span class="o">-</span> <span class="mi">4</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">y_</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x_</span><span class="si">:</span><span class="s1">,.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span>
        <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Average of Portion Paid according to Loan Grade, </span><span class="se">\n</span><span class="s1">Bad Loan&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2_Data_exploration_95_0.png" src="_images/2_Data_exploration_95_0.png" />
</div>
</div>
<p>As we can see, the loan <code class="docutils literal notranslate"><span class="pre">grade</span></code> explains the loan risk very well. Based on evidence above, we expect lower fund recovery for defaulted lower grade loan.</p>
</section>
<section id="employment-length-by-loan-status">
<h4><strong>Employment Length by Loan Status</strong><a class="headerlink" href="#employment-length-by-loan-status" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_categorical_count</span><span class="p">(</span><span class="s1">&#39;emp_length&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2_Data_exploration_98_0.png" src="_images/2_Data_exploration_98_0.png" />
</div>
</div>
<p>Majority of the loaner has a senior employment status with 10 years experience or more. There is no distinguishable pattern whether lower employment length or higher employment length provide (significant) evidence of more likely to be defaulted on loan.</p>
</section>
<section id="home-ownership-by-loan-status">
<h4><strong>Home Ownership by Loan Status</strong><a class="headerlink" href="#home-ownership-by-loan-status" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_categorical_count</span><span class="p">(</span><span class="s1">&#39;home_ownership&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2_Data_exploration_101_0.png" src="_images/2_Data_exploration_101_0.png" />
</div>
</div>
<p>Again, there is no distinguishable pattern whether particular home ownership is (significantly) more likely to be defaulted on loan. However, we can see that <code class="docutils literal notranslate"><span class="pre">RENT</span></code> ownership (by proportion of <code class="docutils literal notranslate"><span class="pre">Bad</span> <span class="pre">Loan</span></code> within classes) has a slighter evidence of more likely to be defaulted than <code class="docutils literal notranslate"><span class="pre">MORTGAGE</span></code>.</p>
</section>
<section id="loan-status-by-purpose">
<h4><strong>Loan Status by Purpose</strong><a class="headerlink" href="#loan-status-by-purpose" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_categorical_count</span><span class="p">(</span><span class="s1">&#39;purpose&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2_Data_exploration_104_0.png" src="_images/2_Data_exploration_104_0.png" />
</div>
</div>
<p>Based on above plot, there is evidence that loan for <code class="docutils literal notranslate"><span class="pre">small_business</span></code> has a slightly higher defaulted portion among other classes.</p>
</section>
<section id="loan-status-by-term">
<h4><strong>Loan Status by Term</strong><a class="headerlink" href="#loan-status-by-term" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_categorical_count</span><span class="p">(</span><span class="s1">&#39;term&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2_Data_exploration_107_0.png" src="_images/2_Data_exploration_107_0.png" />
</div>
</div>
<p>Considering the frequency of submitted loan, 36-months term dominates the longer 60-months term. Moreover, there is slightly higher evidence of defaulted loan for 60-months term.</p>
</section>
</section>
<section id="numerical-data">
<h3>3.2. Numerical Data<a class="headerlink" href="#numerical-data" title="Permalink to this headline">#</a></h3>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loan_df_subset</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>member_id</th>
      <th>loan_amnt</th>
      <th>funded_amnt</th>
      <th>funded_amnt_inv</th>
      <th>int_rate</th>
      <th>installment</th>
      <th>annual_inc</th>
      <th>dti</th>
      <th>delinq_2yrs</th>
      <th>inq_last_6mths</th>
      <th>mths_since_last_delinq</th>
      <th>mths_since_last_record</th>
      <th>open_acc</th>
      <th>pub_rec</th>
      <th>revol_bal</th>
      <th>revol_util</th>
      <th>total_acc</th>
      <th>out_prncp</th>
      <th>out_prncp_inv</th>
      <th>total_pymnt</th>
      <th>total_pymnt_inv</th>
      <th>total_rec_prncp</th>
      <th>total_rec_int</th>
      <th>total_rec_late_fee</th>
      <th>recoveries</th>
      <th>collection_recovery_fee</th>
      <th>last_pymnt_amnt</th>
      <th>collections_12_mths_ex_med</th>
      <th>mths_since_last_major_derog</th>
      <th>policy_code</th>
      <th>annual_inc_joint</th>
      <th>dti_joint</th>
      <th>acc_now_delinq</th>
      <th>tot_coll_amt</th>
      <th>tot_cur_bal</th>
      <th>open_acc_6m</th>
      <th>open_il_12m</th>
      <th>open_il_24m</th>
      <th>mths_since_rcnt_il</th>
      <th>total_bal_il</th>
      <th>il_util</th>
      <th>open_rv_12m</th>
      <th>open_rv_24m</th>
      <th>max_bal_bc</th>
      <th>all_util</th>
      <th>total_rev_hi_lim</th>
      <th>inq_fi</th>
      <th>total_cu_tl</th>
      <th>inq_last_12m</th>
      <th>portion_paid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
      <td>210406.00</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>17644379.16</td>
      <td>19422532.73</td>
      <td>14336.58</td>
      <td>14336.53</td>
      <td>14329.64</td>
      <td>14.41</td>
      <td>442.15</td>
      <td>73727.65</td>
      <td>17.55</td>
      <td>0.31</td>
      <td>0.85</td>
      <td>67.79</td>
      <td>95.43</td>
      <td>11.39</td>
      <td>0.18</td>
      <td>15673.67</td>
      <td>55.46</td>
      <td>25.87</td>
      <td>1180.41</td>
      <td>1179.98</td>
      <td>13214.67</td>
      <td>13208.02</td>
      <td>11137.08</td>
      <td>1921.02</td>
      <td>0.84</td>
      <td>155.73</td>
      <td>16.57</td>
      <td>6886.24</td>
      <td>0.01</td>
      <td>84.75</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.00</td>
      <td>205.38</td>
      <td>136847.80</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>98.92</td>
      <td>38.95</td>
      <td>0.07</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>5.98</td>
      <td>0.06</td>
      <td>29431.11</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>79.46</td>
    </tr>
    <tr>
      <th>std</th>
      <td>16276714.56</td>
      <td>17185356.83</td>
      <td>8260.50</td>
      <td>8260.42</td>
      <td>8256.93</td>
      <td>4.45</td>
      <td>247.72</td>
      <td>61681.61</td>
      <td>7.98</td>
      <td>0.83</td>
      <td>1.07</td>
      <td>35.66</td>
      <td>13.75</td>
      <td>5.01</td>
      <td>0.50</td>
      <td>19915.88</td>
      <td>23.83</td>
      <td>11.82</td>
      <td>4309.23</td>
      <td>4307.63</td>
      <td>9563.25</td>
      <td>9558.63</td>
      <td>8601.51</td>
      <td>2016.14</td>
      <td>6.02</td>
      <td>724.20</td>
      <td>102.95</td>
      <td>7603.61</td>
      <td>0.11</td>
      <td>26.64</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.07</td>
      <td>20022.01</td>
      <td>151386.21</td>
      <td>0.06</td>
      <td>0.05</td>
      <td>0.09</td>
      <td>2.67</td>
      <td>1672.06</td>
      <td>2.36</td>
      <td>0.07</td>
      <td>0.14</td>
      <td>246.75</td>
      <td>2.08</td>
      <td>29448.80</td>
      <td>0.07</td>
      <td>0.14</td>
      <td>0.15</td>
      <td>35.23</td>
    </tr>
    <tr>
      <th>min</th>
      <td>57167.00</td>
      <td>137225.00</td>
      <td>1000.00</td>
      <td>1000.00</td>
      <td>950.00</td>
      <td>5.32</td>
      <td>27.85</td>
      <td>3000.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>2.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>-4.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>5414798.50</td>
      <td>6418125.50</td>
      <td>8000.00</td>
      <td>8000.00</td>
      <td>8000.00</td>
      <td>11.14</td>
      <td>264.94</td>
      <td>45000.00</td>
      <td>11.56</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>32.00</td>
      <td>99.00</td>
      <td>8.00</td>
      <td>0.00</td>
      <td>6221.00</td>
      <td>38.20</td>
      <td>17.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>5873.48</td>
      <td>5870.61</td>
      <td>4186.32</td>
      <td>617.55</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>536.01</td>
      <td>0.00</td>
      <td>80.00</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>28371.25</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>99.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>13200.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>57.32</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>10844643.00</td>
      <td>12637728.50</td>
      <td>12000.00</td>
      <td>12000.00</td>
      <td>12000.00</td>
      <td>14.09</td>
      <td>388.00</td>
      <td>64000.00</td>
      <td>17.13</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>99.00</td>
      <td>99.00</td>
      <td>11.00</td>
      <td>0.00</td>
      <td>11272.00</td>
      <td>56.60</td>
      <td>24.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>11081.14</td>
      <td>11076.12</td>
      <td>9600.00</td>
      <td>1309.17</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>4483.09</td>
      <td>0.00</td>
      <td>99.00</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>78664.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>99.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>22000.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>27651024.25</td>
      <td>30143527.75</td>
      <td>20000.00</td>
      <td>20000.00</td>
      <td>19950.00</td>
      <td>17.56</td>
      <td>577.01</td>
      <td>89000.00</td>
      <td>23.24</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>99.00</td>
      <td>99.00</td>
      <td>14.00</td>
      <td>0.00</td>
      <td>19537.00</td>
      <td>74.00</td>
      <td>33.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>18314.52</td>
      <td>18305.10</td>
      <td>16000.00</td>
      <td>2470.88</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>10772.06</td>
      <td>0.00</td>
      <td>99.00</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>205955.75</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>99.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>36500.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>max</th>
      <td>68604659.00</td>
      <td>73507418.00</td>
      <td>35000.00</td>
      <td>35000.00</td>
      <td>35000.00</td>
      <td>28.99</td>
      <td>1424.57</td>
      <td>8900060.00</td>
      <td>39.99</td>
      <td>29.00</td>
      <td>7.00</td>
      <td>152.00</td>
      <td>121.00</td>
      <td>76.00</td>
      <td>20.00</td>
      <td>1746716.00</td>
      <td>892.30</td>
      <td>150.00</td>
      <td>35000.00</td>
      <td>35000.00</td>
      <td>56087.91</td>
      <td>56047.85</td>
      <td>35000.00</td>
      <td>21087.91</td>
      <td>358.68</td>
      <td>33520.27</td>
      <td>5694.09</td>
      <td>36475.59</td>
      <td>6.00</td>
      <td>159.00</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.00</td>
      <td>9152545.00</td>
      <td>8000078.00</td>
      <td>6.00</td>
      <td>6.00</td>
      <td>14.00</td>
      <td>193.00</td>
      <td>249212.00</td>
      <td>129.20</td>
      <td>8.00</td>
      <td>21.00</td>
      <td>30567.00</td>
      <td>102.80</td>
      <td>2013133.00</td>
      <td>9.00</td>
      <td>21.00</td>
      <td>19.00</td>
      <td>100.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="loan-ecosystem-growth">
<h4><strong>Loan Ecosystem Growth</strong><a class="headerlink" href="#loan-ecosystem-growth" title="Permalink to this headline">#</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aggr_funding</span> <span class="o">=</span> <span class="n">loan_df</span>\
    <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;issue_d&#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)])</span>\
    <span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;funded_amnt_inv&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">})</span>\
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1"># plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">aggr_funding</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;issue_d&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;funded_amnt_inv&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Monthly Average Funded Amount&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2_Data_exploration_112_0.png" src="_images/2_Data_exploration_112_0.png" />
</div>
</div>
<p>We can see that participation of loan was increasing along time.</p>
</section>
<section id="stability-of-interest-rate">
<h4><strong>Stability of Interest Rate</strong><a class="headerlink" href="#stability-of-interest-rate" title="Permalink to this headline">#</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aggr_int_rate</span> <span class="o">=</span> <span class="n">loan_df</span>\
    <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;issue_d&#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">),</span> <span class="s1">&#39;loan_category&#39;</span><span class="p">])</span>\
    <span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;int_rate&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">})</span>\
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1"># plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">color_order</span> <span class="o">=</span> <span class="p">[</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">aggr_int_rate</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;issue_d&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;int_rate&#39;</span><span class="p">,</span> 
    <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;loan_category&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">color_order</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Monthly Average Interest Rate&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2_Data_exploration_115_0.png" src="_images/2_Data_exploration_115_0.png" />
</div>
</div>
<p>Upward trend in successful loan may suggest healthy ecosystem of investment and vice versa.</p>
</section>
<section id="correlation-coefficient">
<h4><strong>Correlation Coefficient</strong><a class="headerlink" href="#correlation-coefficient" title="Permalink to this headline">#</a></h4>
<p>We are going to use correlation coefficient that works with categorical problem: <code class="docutils literal notranslate"><span class="pre">Point</span> <span class="pre">Biserial</span></code> and <code class="docutils literal notranslate"><span class="pre">Phi-k</span></code> correlation coefficient.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">phik</span>
<span class="kn">from</span> <span class="nn">phik</span> <span class="kn">import</span> <span class="n">resources</span><span class="p">,</span> <span class="n">report</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="k">def</span> <span class="nf">categorical_corr_table</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">sample_size</span><span class="p">:</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">sample_size</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1"># phi-k correlation matrix</span>
    <span class="n">X_phik_corr</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">phik_matrix</span><span class="p">()[</span><span class="s1">&#39;loan_category&#39;</span><span class="p">]</span>
    <span class="c1"># point biserial correlation</span>
    <span class="n">pbis_corr</span><span class="p">,</span> <span class="n">pbis_p</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">X</span><span class="o">.</span><span class="n">loan_category</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">loan_category</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="s1">&#39;Good Loan&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Bad Loan&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
    <span class="k">for</span> <span class="n">var_</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pbis_corr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">stats</span><span class="o">.</span><span class="n">pointbiserialr</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">var_</span><span class="p">],</span> 
                <span class="n">X</span><span class="p">[</span><span class="s1">&#39;loan_category&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="n">pbis_p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">stats</span><span class="o">.</span><span class="n">pointbiserialr</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">var_</span><span class="p">],</span> 
                <span class="n">X</span><span class="p">[</span><span class="s1">&#39;loan_category&#39;</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span>
                <span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span> <span class="c1"># Error caused by NaN records</span>
            <span class="n">pbis_corr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">stats</span><span class="o">.</span><span class="n">pointbiserialr</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">X</span><span class="p">[</span><span class="n">var_</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">(),</span> <span class="n">var_</span><span class="p">],</span> 
                <span class="n">X</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">X</span><span class="p">[</span><span class="n">var_</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">(),</span> <span class="s1">&#39;loan_category&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="n">pbis_p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">stats</span><span class="o">.</span><span class="n">pointbiserialr</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">X</span><span class="p">[</span><span class="n">var_</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">(),</span> <span class="n">var_</span><span class="p">],</span> 
                <span class="n">X</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">X</span><span class="p">[</span><span class="n">var_</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">(),</span> <span class="s1">&#39;loan_category&#39;</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span>
                <span class="p">)</span>
    <span class="n">X_pbis_corr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pbis_corr</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">X_pbis_p</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pbis_p</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="c1">#combining subset</span>
    <span class="n">X_corr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_phik_corr</span><span class="p">,</span>
                                    <span class="n">X_pbis_corr</span><span class="p">,</span>
                                    <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_pbis_corr</span><span class="p">),</span>
                                    <span class="n">X_pbis_p</span><span class="p">],</span>
                                    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">X_corr</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;phi-k corr.&#39;</span><span class="p">,</span> <span class="s1">&#39;point biserial corr.&#39;</span><span class="p">,</span> <span class="s1">&#39;point biserial corr. (mag.)&#39;</span><span class="p">,</span> <span class="s1">&#39;point biserial p-value&#39;</span>
        <span class="p">]</span>
    <span class="k">return</span> <span class="n">X_corr</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">applicant_ftrs_nums</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;loan_category&#39;</span><span class="p">]</span>
    <span class="o">+</span> <span class="n">loan_df_subset</span><span class="p">[</span><span class="n">applicant_features</span><span class="p">]</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="s1">&#39;datetime64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="p">)</span> 
<span class="n">loan_ftrs_nums</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;loan_category&#39;</span><span class="p">]</span>
    <span class="o">+</span> <span class="n">loan_df_subset</span><span class="p">[</span><span class="n">loan_features</span><span class="p">]</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="s1">&#39;datetime64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="p">)</span>
<span class="n">dfs_to_plot</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">loan_df_subset</span><span class="p">[</span><span class="n">applicant_ftrs_nums</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;annual_inc_joint&#39;</span><span class="p">,</span> <span class="s1">&#39;dti_joint&#39;</span><span class="p">,</span> <span class="s1">&#39;member_id&#39;</span><span class="p">,</span> <span class="s1">&#39;policy_code&#39;</span><span class="p">]),</span> 
    <span class="n">loan_df_subset</span><span class="p">[</span><span class="n">loan_ftrs_nums</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;policy_code&#39;</span><span class="p">])]</span> 
<span class="c1"># plot point biserial correlation</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">df_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dfs_to_plot</span><span class="p">):</span>
    <span class="n">corr_df</span> <span class="o">=</span> <span class="n">categorical_corr_table</span><span class="p">(</span><span class="n">df_</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
    <span class="n">plot_corr_df</span> <span class="o">=</span> <span class="n">corr_df</span>\
        <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;loan_category&#39;</span><span class="p">)</span>\
        <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
        <span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">],</span> 
              <span class="n">value_vars</span><span class="o">=</span><span class="n">corr_df</span><span class="o">.</span><span class="n">columns</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
    <span class="n">plot_order</span> <span class="o">=</span> <span class="n">corr_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;loan_category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;point biserial corr. (mag.)&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;variable&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">plot_corr_df</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">plot_order</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Correlation Coefficient, loan_category&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Correlation Coefficient of Numerical Features&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>interval columns not set, guessing: [&#39;annual_inc&#39;, &#39;dti&#39;, &#39;delinq_2yrs&#39;, &#39;inq_last_6mths&#39;, &#39;mths_since_last_delinq&#39;, &#39;mths_since_last_record&#39;, &#39;open_acc&#39;, &#39;revol_bal&#39;, &#39;revol_util&#39;, &#39;total_acc&#39;, &#39;collections_12_mths_ex_med&#39;, &#39;mths_since_last_major_derog&#39;, &#39;acc_now_delinq&#39;, &#39;tot_coll_amt&#39;, &#39;tot_cur_bal&#39;, &#39;open_acc_6m&#39;, &#39;open_il_12m&#39;, &#39;open_il_24m&#39;, &#39;mths_since_rcnt_il&#39;, &#39;total_bal_il&#39;, &#39;il_util&#39;, &#39;open_rv_12m&#39;, &#39;open_rv_24m&#39;, &#39;all_util&#39;, &#39;total_rev_hi_lim&#39;, &#39;inq_fi&#39;, &#39;total_cu_tl&#39;, &#39;inq_last_12m&#39;, &#39;pub_rec&#39;, &#39;max_bal_bc&#39;]
interval columns not set, guessing: [&#39;loan_amnt&#39;, &#39;int_rate&#39;, &#39;installment&#39;]
</pre></div>
</div>
<img alt="_images/2_Data_exploration_120_1.png" src="_images/2_Data_exploration_120_1.png" />
</div>
</div>
<p>High difference in correlation coefficient magnitude occurs for features <code class="docutils literal notranslate"><span class="pre">revol_util</span></code>, <code class="docutils literal notranslate"><span class="pre">tot_cur_bal</span></code>, <code class="docutils literal notranslate"><span class="pre">ann_inc</span></code>, and <code class="docutils literal notranslate"><span class="pre">total_rev_hi_lim</span></code>.</p>
<p>Let’s check the distribution of each parameters.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ftrs_nums</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;loan_category&#39;</span><span class="p">]</span>
    <span class="o">+</span> <span class="n">loan_df_subset</span><span class="p">[</span><span class="n">applicant_features</span><span class="p">]</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="s1">&#39;datetime64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="o">+</span> <span class="n">loan_df_subset</span><span class="p">[</span><span class="n">loan_features</span><span class="p">]</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="s1">&#39;datetime64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="p">)</span>
<span class="n">plot_df</span> <span class="o">=</span> <span class="n">loan_df_subset</span><span class="p">[</span><span class="n">ftrs_nums</span><span class="p">]</span>\
    <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dti_joint&#39;</span><span class="p">,</span> <span class="s1">&#39;annual_inc_joint&#39;</span><span class="p">,</span> <span class="s1">&#39;member_id&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;policy_code&#39;</span><span class="p">])</span>
<span class="n">corr_df</span> <span class="o">=</span> <span class="n">categorical_corr_table</span><span class="p">(</span><span class="n">plot_df</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">corr_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;loan_category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;point biserial corr. (mag.)&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">axes</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">plot_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;loan_category&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">plot_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;loan_category&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Histogram, </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Central Tendency, </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>interval columns not set, guessing: [&#39;annual_inc&#39;, &#39;dti&#39;, &#39;delinq_2yrs&#39;, &#39;inq_last_6mths&#39;, &#39;mths_since_last_delinq&#39;, &#39;mths_since_last_record&#39;, &#39;open_acc&#39;, &#39;revol_bal&#39;, &#39;revol_util&#39;, &#39;total_acc&#39;, &#39;collections_12_mths_ex_med&#39;, &#39;mths_since_last_major_derog&#39;, &#39;acc_now_delinq&#39;, &#39;tot_coll_amt&#39;, &#39;tot_cur_bal&#39;, &#39;open_acc_6m&#39;, &#39;open_il_12m&#39;, &#39;open_il_24m&#39;, &#39;mths_since_rcnt_il&#39;, &#39;total_bal_il&#39;, &#39;il_util&#39;, &#39;open_rv_12m&#39;, &#39;open_rv_24m&#39;, &#39;all_util&#39;, &#39;total_rev_hi_lim&#39;, &#39;inq_fi&#39;, &#39;total_cu_tl&#39;, &#39;inq_last_12m&#39;, &#39;pub_rec&#39;, &#39;max_bal_bc&#39;, &#39;loan_amnt&#39;, &#39;int_rate&#39;, &#39;installment&#39;]
</pre></div>
</div>
<img alt="_images/2_Data_exploration_122_1.png" src="_images/2_Data_exploration_122_1.png" />
</div>
</div>
<p>From above plots, points observed:</p>
<ul class="simple">
<li><p>Variables from above to below is sorted by the highest to lowest correlation coefficient.</p></li>
<li><p>Interest rate (<code class="docutils literal notranslate"><span class="pre">int_rate</span></code>) is the most highly associated with <code class="docutils literal notranslate"><span class="pre">Bad</span> <span class="pre">Loan</span></code> among others. We know previously that higher <code class="docutils literal notranslate"><span class="pre">int_rate</span></code> is associated with lower loan <code class="docutils literal notranslate"><span class="pre">grade</span></code>, which reflects the quality of the loan.</p></li>
<li><p>Each variables has a highly different value scales, needs to be standardized.</p></li>
<li><p>From above to below, the location of box plot (reflects the center of distribution) between <code class="docutils literal notranslate"><span class="pre">Good</span> <span class="pre">Loan</span></code> and <code class="docutils literal notranslate"><span class="pre">Bad</span> <span class="pre">Loan</span></code> class is becoming less different. It may inform that the more different the distribution between classes, the more that variable may be useful and importance to the model as classification features.</p></li>
<li><p>We should focus on several features that has skewed (right-skewed, specifically) distributions and have a high number of outliers.</p></li>
<li><p>it is clear that only <code class="docutils literal notranslate"><span class="pre">dti</span></code> has a more normal-distribution than others, identified by the histogram and well-balanced boxplot (centered median and balanced whisker for class <code class="docutils literal notranslate"><span class="pre">Bad</span> <span class="pre">Loan</span></code>, however class <code class="docutils literal notranslate"><span class="pre">Good</span> <span class="pre">Loan</span></code> is less Gaussian). Other than that, especially <code class="docutils literal notranslate"><span class="pre">revol_util</span></code>, <code class="docutils literal notranslate"><span class="pre">tot_cur_bal</span></code>, <code class="docutils literal notranslate"><span class="pre">ann_inc</span></code>, <code class="docutils literal notranslate"><span class="pre">total_rev_hi_lim</span></code> and other variables that has correlation coefficient close to zero, has a lot of outliers.</p></li>
<li><p>For features that majority records zeroes (for example <code class="docutils literal notranslate"><span class="pre">pub_rec</span></code>, <code class="docutils literal notranslate"><span class="pre">acc_now_delinq</span></code>, etc.), the outliers is (probably) not exactly an anomaly. Hence if we simply discard it we may lose important information that may reduce our data representativeness. In the next process we will conduct more detailed outlier identification for each of the features.</p></li>
</ul>
<p>Closing note for our numerical features: less gaussian distribution, a lot of outliers, and a less linearly related variables make our feature analysis by utilizing correlation coefficient is not properly suitable for our dataset. Indeed we still can  observe generally which variables may be potential for our model features and which one may be discarded to avoid overfitting.</p>
<p>Later, more robust methods for feature selection will be conducted if necessary. Feature transformation to make the distribution more Gaussian will also be conducted.</p>
</section>
<section id="multicollinearity">
<h4><strong>Multicollinearity</strong><a class="headerlink" href="#multicollinearity" title="Permalink to this headline">#</a></h4>
<p>Collinearity between predictor variables can mask the importance of a variable that is collinear with such. In multiple regression setting with high degree of predictor variables, it is also possible for collinearity to exist between three or more variables even if no pair of variables has a particularly high correlation, which is called <em>multicollinearity</em>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">VIF</span></code> (variance inflation factor) is known to be a better way to assess mulicollinearity.</p>
<div class="cell tag_hide-input tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.stats.outliers_influence</span> <span class="kn">import</span> <span class="n">variance_inflation_factor</span>

<span class="n">check_vif</span> <span class="o">=</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;loan_category&#39;</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;vif&#39;</span><span class="p">:</span> 
        <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">check_vif</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">check_vif</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
    <span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">check_vif</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;vif&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<p>There is a pair of features that show high collinearity: <code class="docutils literal notranslate"><span class="pre">loan_amnt</span></code> and <code class="docutils literal notranslate"><span class="pre">installment</span></code>. According to the explanation, it is clear because installment is a monthly payment based on loan amount (+ <em>interest</em>) divided by number of payment (i.e. loan <code class="docutils literal notranslate"><span class="pre">term</span></code>). So we can just use <code class="docutils literal notranslate"><span class="pre">installment</span></code> to cover both <code class="docutils literal notranslate"><span class="pre">loan_amnt</span></code> and <code class="docutils literal notranslate"><span class="pre">term</span></code>.</p>
<p>Multicollinearity only impacts multiple regression model and should be considered carefully.</p>
</section>
</section>
</section>
<section id="summary">
<h2>4. Summary<a class="headerlink" href="#summary" title="Permalink to this headline">#</a></h2>
<p>We already got some understanding for a credit business and the motivation behind developing machine learning classifier, specifically for <em>Lending Club Peer-to-peer Loan</em>, although the provided dataset may set constraint for our model here and there.</p>
<p>Then, we discovered that our dataset has several variables that uninsightful for machine learning modeling. Also, the characteristic of our data is not ideal enough to implement statistical method directly hence need some cleaning and transformations.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="1_Dataset_indentification_and_preprocessing.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">LendingClub Dataset - A collection of Peer-to-Peer Individual Loan History</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="3_Model_development.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Implementing Machine Learning Model to Predict and Select Loan</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Nafis Barizki<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>